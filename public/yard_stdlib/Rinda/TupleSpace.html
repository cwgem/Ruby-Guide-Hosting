<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Rinda::TupleSpace
  
    &mdash; Ruby 1.9 Ruby Standard Library
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (T)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Rinda.html" title="Rinda (module)">Rinda</a></span></span>
     &raquo; 
    <span class="title">TupleSpace</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Rinda::TupleSpace
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Rinda::TupleSpace</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../DRb/DRbUndumped.html" title="DRb::DRbUndumped (module)">DRb::DRbUndumped</a></span>, <span class='object_link'><a href="../MonitorMixin.html" title="MonitorMixin (module)">MonitorMixin</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/rinda/tuplespace.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Tuplespace manages access to the tuples it contains, ensuring mutual
exclusion requirements are met.</p>

<p>The <tt>sec</tt> option for the write, take, move, read and notify methods
may either be a number of seconds or a Renewer object.</p>


  </div>
</div>
<div class="tags">
  
</div>

  
  
  
  
  
  
  
  


  
  
  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_entry-instance_method" title="#create_entry (instance method)">- (Object) <strong>create_entry</strong>(tuple, sec) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (TupleSpace) <strong>initialize</strong>(period = 60) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new TupleSpace.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#keep_clean-instance_method" title="#keep_clean (instance method)">- (Object) <strong>keep_clean</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Removes dead tuples.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move-instance_method" title="#move (instance method)">- (Object) <strong>move</strong>(port, tuple, sec = nil) {|template| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Moves <tt>tuple</tt> to <tt>port</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#need_keeper%3F-instance_method" title="#need_keeper? (instance method)">- (Boolean) <strong>need_keeper?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks the tuplespace to see if it needs cleaning.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#notify-instance_method" title="#notify (instance method)">- (Object) <strong>notify</strong>(event, tuple, sec = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Registers for notifications of <tt>event</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#notify_event-instance_method" title="#notify_event (instance method)">- (Object) <strong>notify_event</strong>(event, tuple) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Notifies all registered listeners for <tt>event</tt> of a status change of
<tt>tuple</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read-instance_method" title="#read (instance method)">- (Object) <strong>read</strong>(tuple, sec = nil) {|template| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reads <tt>tuple</tt>, but does not remove it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_all-instance_method" title="#read_all (instance method)">- (Object) <strong>read_all</strong>(tuple) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns all tuples matching <tt>tuple</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_keeper-instance_method" title="#start_keeper (instance method)">- (Object) <strong>start_keeper</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a thread that scans the tuplespace for expired tuples.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#take-instance_method" title="#take (instance method)">- (Object) <strong>take</strong>(tuple, sec = nil, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Removes <tt>tuple</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write-instance_method" title="#write (instance method)">- (Object) <strong>write</strong>(tuple, sec = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds <tt>tuple</tt>.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../MonitorMixin.html" title="MonitorMixin (module)">MonitorMixin</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../MonitorMixin.html#extend_object-class_method" title="MonitorMixin.extend_object (method)">extend_object</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_check_owner-instance_method" title="MonitorMixin#mon_check_owner (method)">#mon_check_owner</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_enter-instance_method" title="MonitorMixin#mon_enter (method)">#mon_enter</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_enter_for_cond-instance_method" title="MonitorMixin#mon_enter_for_cond (method)">#mon_enter_for_cond</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_exit-instance_method" title="MonitorMixin#mon_exit (method)">#mon_exit</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_exit_for_cond-instance_method" title="MonitorMixin#mon_exit_for_cond (method)">#mon_exit_for_cond</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_initialize-instance_method" title="MonitorMixin#mon_initialize (method)">#mon_initialize</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_synchronize-instance_method" title="MonitorMixin#mon_synchronize (method)">#mon_synchronize</a></span>, <span class='object_link'><a href="../MonitorMixin.html#mon_try_enter-instance_method" title="MonitorMixin#mon_try_enter (method)">#mon_try_enter</a></span>, <span class='object_link'><a href="../MonitorMixin.html#new_cond-instance_method" title="MonitorMixin#new_cond (method)">#new_cond</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../DRb/DRbUndumped.html" title="DRb::DRbUndumped (module)">DRb::DRbUndumped</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../DRb/DRbUndumped.html#_dump-instance_method" title="DRb::DRbUndumped#_dump (method)">#_dump</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Rinda::TupleSpace (class)">TupleSpace</a></span></tt>) <strong>initialize</strong>(period = 60) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Creates a new TupleSpace.  <tt>period</tt> is used to control how often to
look for dead tuples after modifications to the TupleSpace.</p>

<p>If no dead tuples are found <tt>period</tt> seconds after the last
modification, the TupleSpace will stop looking for dead tuples.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


438
439
440
441
442
443
444
445
446</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 438</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id period'>period</span><span class='op'>=</span><span class='int'>60</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='ivar'>@bag</span> <span class='op'>=</span> <span class='const'>TupleBag</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@read_waiter</span> <span class='op'>=</span> <span class='const'>TupleBag</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@take_waiter</span> <span class='op'>=</span> <span class='const'>TupleBag</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@notify_waiter</span> <span class='op'>=</span> <span class='const'>TupleBag</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@period</span> <span class='op'>=</span> <span class='id period'>period</span>
  <span class='ivar'>@keeper</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="create_entry-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>create_entry</strong>(tuple, sec) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


578
579
580</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 578</span>

<span class='kw'>def</span> <span class='id create_entry'>create_entry</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
  <span class='const'>TupleEntry</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="keep_clean-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>keep_clean</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Removes dead tuples.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 585</span>

<span class='kw'>def</span> <span class='id keep_clean'>keep_clean</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id delete_unless_alive'>delete_unless_alive</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span>
      <span class='id e'>e</span><span class='period'>.</span><span class='id signal'>signal</span>
    <span class='kw'>end</span>
    <span class='ivar'>@take_waiter</span><span class='period'>.</span><span class='id delete_unless_alive'>delete_unless_alive</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span>
      <span class='id e'>e</span><span class='period'>.</span><span class='id signal'>signal</span>
    <span class='kw'>end</span>
    <span class='ivar'>@notify_waiter</span><span class='period'>.</span><span class='id delete_unless_alive'>delete_unless_alive</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span>
      <span class='id e'>e</span><span class='period'>.</span><span class='id notify'>notify</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>close</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='ivar'>@bag</span><span class='period'>.</span><span class='id delete_unless_alive'>delete_unless_alive</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span>
      <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>delete</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id e'>e</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="move-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>move</strong>(port, tuple, sec = nil) {|template| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Moves <tt>tuple</tt> to <tt>port</tt>.</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>template</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 485</span>

<span class='kw'>def</span> <span class='id move'>move</span><span class='lparen'>(</span><span class='id port'>port</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id template'>template</span> <span class='op'>=</span> <span class='const'>WaitTemplateEntry</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
  <span class='kw'>yield</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id entry'>entry</span> <span class='op'>=</span> <span class='ivar'>@bag</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id entry'>entry</span>
      <span class='id port'>port</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id port'>port</span>
      <span class='ivar'>@bag</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span>
      <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>take</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span>
    <span class='kw'>end</span>
    <span class='id raise'>raise</span> <span class='const'>RequestExpiredError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expired?'>expired?</span>

    <span class='kw'>begin</span>
      <span class='ivar'>@take_waiter</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
      <span class='id start_keeper'>start_keeper</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expires'>expires</span>
      <span class='kw'>while</span> <span class='kw'>true</span>
        <span class='id raise'>raise</span> <span class='const'>RequestCanceledError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id canceled?'>canceled?</span>
        <span class='id raise'>raise</span> <span class='const'>RequestExpiredError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expired?'>expired?</span>
        <span class='id entry'>entry</span> <span class='op'>=</span> <span class='ivar'>@bag</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id entry'>entry</span>
          <span class='id port'>port</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id port'>port</span>
          <span class='ivar'>@bag</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span>
          <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>take</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
          <span class='kw'>return</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span>
        <span class='kw'>end</span>
        <span class='id template'>template</span><span class='period'>.</span><span class='id wait'>wait</span>
      <span class='kw'>end</span>
    <span class='kw'>ensure</span>
      <span class='ivar'>@take_waiter</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="need_keeper?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>need_keeper?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Checks the tuplespace to see if it needs cleaning.</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


632
633
634
635
636
637</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 632</span>

<span class='kw'>def</span> <span class='id need_keeper?'>need_keeper?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@bag</span><span class='period'>.</span><span class='id has_expires?'>has_expires?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id has_expires?'>has_expires?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@take_waiter</span><span class='period'>.</span><span class='id has_expires?'>has_expires?</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@notify_waiter</span><span class='period'>.</span><span class='id has_expires?'>has_expires?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="notify-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>notify</strong>(event, tuple, sec = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Registers for notifications of <tt>event</tt>.  Returns a
NotifyTemplateEntry. See NotifyTemplateEntry for examples of how to listen
for notifications.</p>

<p><tt>event</tt> can be:</p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p>'write'</p></td>
<td>
<p>A tuple was added</p>
</td></tr><tr><td class="rdoc-term"><p>'take'</p></td>
<td>
<p>A tuple was taken or moved</p>
</td></tr><tr><td class="rdoc-term"><p>'delete'</p></td>
<td>
<p>A tuple was lost after being overwritten or expiring</p>
</td></tr></table>

<p>The TupleSpace will also notify you of the 'close' event when the
NotifyTemplateEntry has expired.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


568
569
570
571
572
573
574</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 568</span>

<span class='kw'>def</span> <span class='id notify'>notify</span><span class='lparen'>(</span><span class='id event'>event</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id template'>template</span> <span class='op'>=</span> <span class='const'>NotifyTemplateEntry</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id event'>event</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='ivar'>@notify_waiter</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id template'>template</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="notify_event-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>notify_event</strong>(event, tuple) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Notifies all registered listeners for <tt>event</tt> of a status change of
<tt>tuple</tt>.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


606
607
608
609
610
611</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 606</span>

<span class='kw'>def</span> <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='id event'>event</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='rparen'>)</span>
  <span class='id ev'>ev</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id event'>event</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='rbracket'>]</span>
  <span class='ivar'>@notify_waiter</span><span class='period'>.</span><span class='id find_all_template'>find_all_template</span><span class='lparen'>(</span><span class='id ev'>ev</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id template'>template</span><span class='op'>|</span>
    <span class='id template'>template</span><span class='period'>.</span><span class='id notify'>notify</span><span class='lparen'>(</span><span class='id ev'>ev</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="read-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>read</strong>(tuple, sec = nil) {|template| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Reads <tt>tuple</tt>, but does not remove it.</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>template</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 522</span>

<span class='kw'>def</span> <span class='id read'>read</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id template'>template</span> <span class='op'>=</span> <span class='const'>WaitTemplateEntry</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
  <span class='kw'>yield</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id entry'>entry</span> <span class='op'>=</span> <span class='ivar'>@bag</span><span class='period'>.</span><span class='id find'>find</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span> <span class='kw'>if</span> <span class='id entry'>entry</span>
    <span class='id raise'>raise</span> <span class='const'>RequestExpiredError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expired?'>expired?</span>

    <span class='kw'>begin</span>
      <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
      <span class='id start_keeper'>start_keeper</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expires'>expires</span>
      <span class='id template'>template</span><span class='period'>.</span><span class='id wait'>wait</span>
      <span class='id raise'>raise</span> <span class='const'>RequestCanceledError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id canceled?'>canceled?</span>
      <span class='id raise'>raise</span> <span class='const'>RequestExpiredError</span> <span class='kw'>if</span> <span class='id template'>template</span><span class='period'>.</span><span class='id expired?'>expired?</span>
      <span class='kw'>return</span> <span class='id template'>template</span><span class='period'>.</span><span class='id found'>found</span>
    <span class='kw'>ensure</span>
      <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="read_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>read_all</strong>(tuple) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns all tuples matching <tt>tuple</tt>.  Does not remove the found
tuples.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


546
547
548
549
550
551
552
553
554</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 546</span>

<span class='kw'>def</span> <span class='id read_all'>read_all</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='rparen'>)</span>
  <span class='id template'>template</span> <span class='op'>=</span> <span class='const'>WaitTemplateEntry</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='id entry'>entry</span> <span class='op'>=</span> <span class='ivar'>@bag</span><span class='period'>.</span><span class='id find_all'>find_all</span><span class='lparen'>(</span><span class='id template'>template</span><span class='rparen'>)</span>
    <span class='id entry'>entry</span><span class='period'>.</span><span class='id collect'>collect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id e'>e</span><span class='op'>|</span>
      <span class='id e'>e</span><span class='period'>.</span><span class='id value'>value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="start_keeper-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>start_keeper</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Creates a thread that scans the tuplespace for expired tuples.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


616
617
618
619
620
621
622
623
624
625
626
627</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 616</span>

<span class='kw'>def</span> <span class='id start_keeper'>start_keeper</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@keeper</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@keeper</span><span class='period'>.</span><span class='id alive?'>alive?</span>
  <span class='ivar'>@keeper</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id new'>new</span> <span class='kw'>do</span>
    <span class='kw'>while</span> <span class='kw'>true</span>
      <span class='id sleep'>sleep</span><span class='lparen'>(</span><span class='ivar'>@period</span><span class='rparen'>)</span>
      <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
        <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id need_keeper?'>need_keeper?</span>
        <span class='id keep_clean'>keep_clean</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="take-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>take</strong>(tuple, sec = nil, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Removes <tt>tuple</tt></p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


478
479
480</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 478</span>

<span class='kw'>def</span> <span class='id take'>take</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
  <span class='id move'>move</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="write-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>write</strong>(tuple, sec = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds <tt>tuple</tt></p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rinda/tuplespace.rb', line 451</span>

<span class='kw'>def</span> <span class='id write'>write</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id entry'>entry</span> <span class='op'>=</span> <span class='id create_entry'>create_entry</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='comma'>,</span> <span class='id sec'>sec</span><span class='rparen'>)</span>
  <span class='id synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id expired?'>expired?</span>
      <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id find_all_template'>find_all_template</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id template'>template</span><span class='op'>|</span>
        <span class='id template'>template</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>write</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
      <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>delete</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='ivar'>@bag</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span>
      <span class='id start_keeper'>start_keeper</span> <span class='kw'>if</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id expires'>expires</span>
      <span class='ivar'>@read_waiter</span><span class='period'>.</span><span class='id find_all_template'>find_all_template</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id template'>template</span><span class='op'>|</span>
        <span class='id template'>template</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id tuple'>tuple</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='ivar'>@take_waiter</span><span class='period'>.</span><span class='id find_all_template'>find_all_template</span><span class='lparen'>(</span><span class='id entry'>entry</span><span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id template'>template</span><span class='op'>|</span>
        <span class='id template'>template</span><span class='period'>.</span><span class='id signal'>signal</span>
      <span class='kw'>end</span>
      <span class='id notify_event'>notify_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>write</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id entry'>entry</span><span class='period'>.</span><span class='id value'>value</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id entry'>entry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Sep  3 14:11:20 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.3).
</div>

  </body>
</html>