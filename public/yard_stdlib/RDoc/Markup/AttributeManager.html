<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: RDoc::Markup::AttributeManager
  
    &mdash; Ruby 1.9 Ruby Standard Library
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../RDoc.html" title="RDoc (module)">RDoc</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Markup.html" title="RDoc::Markup (class)">Markup</a></span></span>
     &raquo; 
    <span class="title">AttributeManager</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: RDoc::Markup::AttributeManager
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">RDoc::Markup::AttributeManager</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/rdoc/markup/attribute_manager.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Manages changes of attributes in a block of text</p>


  </div>
</div>
<div class="tags">
  
</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="NULL-constant" class="">NULL =
          <div class="docstring">
  <div class="discussion">
    
<p>The NUL character</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\000</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id freeze'>freeze</span></pre></dd>
      
        <dt id="A_PROTECT-constant" class="">A_PROTECT =
          <div class="docstring">
  <div class="discussion">
    
<p>-- We work by substituting non-printing characters in to the text. For now
I'm assuming that I can substitute a character in the range 0..8 for a 7
bit character without damaging the encoded string, but this might be
optimistic ++</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='int'>004</span></pre></dd>
      
        <dt id="PROTECT_ATTR-constant" class="">PROTECT_ATTR =
          <div class="docstring">
  <div class="discussion">
    
<p>Special mask character to prevent inline markup handling</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='const'>A_PROTECT</span><span class='period'>.</span><span class='id chr'>chr</span></pre></dd>
      
    </dl>
  


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#html_tags-instance_method" title="#html_tags (instance method)">- (Object) <strong>html_tags</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This maps HTML tags to the corresponding attribute char.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#matching_word_pairs-instance_method" title="#matching_word_pairs (instance method)">- (Object) <strong>matching_word_pairs</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This maps delimiters that occur around words (such as <b>bold</b> or
<tt>tt</tt>) where the start and end delimiters and the same.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#protectable-instance_method" title="#protectable (instance method)">- (Object) <strong>protectable</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A \ in front of a character that would normally be processed turns off
processing.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#special-instance_method" title="#special (instance method)">- (Object) <strong>special</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>And this maps <em>special</em> sequences to a name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#word_pair_map-instance_method" title="#word_pair_map (instance method)">- (Object) <strong>word_pair_map</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>And this is used when the delimiters aren't the same.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_html-instance_method" title="#add_html (instance method)">- (Object) <strong>add_html</strong>(tag, name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a markup class with <tt>name</tt> for words surrounded by HTML tag
<tt>tag</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_special-instance_method" title="#add_special (instance method)">- (Object) <strong>add_special</strong>(pattern, name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a special handler for <tt>pattern</tt> with <tt>name</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_word_pair-instance_method" title="#add_word_pair (instance method)">- (Object) <strong>add_word_pair</strong>(start, stop, name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a markup class with <tt>name</tt> for words wrapped in the
<tt>start</tt> and <tt>stop</tt> character.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attribute-instance_method" title="#attribute (instance method)">- (Object) <strong>attribute</strong>(turn_on, turn_off) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return an attribute object with the given turn_on and turn_off bits set.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#change_attribute-instance_method" title="#change_attribute (instance method)">- (Object) <strong>change_attribute</strong>(current, new) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Changes the current attribute from <tt>current</tt> to <tt>new</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#changed_attribute_by_name-instance_method" title="#changed_attribute_by_name (instance method)">- (Object) <strong>changed_attribute_by_name</strong>(current_set, new_set) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Used by the tests to change attributes by name from <tt>current_set</tt> to
<tt>new_set</tt>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert_attrs-instance_method" title="#convert_attrs (instance method)">- (Object) <strong>convert_attrs</strong>(str, attrs) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Map attributes like <b>text</b>to the sequence
001002&lt;char&gt;001003&lt;char&gt;, where &lt;char&gt; is a per-attribute
specific character.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert_html-instance_method" title="#convert_html (instance method)">- (Object) <strong>convert_html</strong>(str, attrs) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts HTML tags to RDoc attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#convert_specials-instance_method" title="#convert_specials (instance method)">- (Object) <strong>convert_specials</strong>(str, attrs) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts special sequences to RDoc attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copy_string-instance_method" title="#copy_string (instance method)">- (Object) <strong>copy_string</strong>(start_pos, end_pos) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Copies <tt>start_pos</tt> to <tt>end_pos</tt> from the current string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#display_attributes-instance_method" title="#display_attributes (instance method)">- (Object) <strong>display_attributes</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Debug method that prints a string along with its attributes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flow-instance_method" title="#flow (instance method)">- (Object) <strong>flow</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Processes <tt>str</tt> converting attributes, HTML and specials.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (AttributeManager) <strong>initialize</strong> </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new attribute manager that understands bold, emphasized and
teletype text.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mask_protected_sequences-instance_method" title="#mask_protected_sequences (instance method)">- (Object) <strong>mask_protected_sequences</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Escapes special sequences of text to prevent conversion to RDoc.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#split_into_flow-instance_method" title="#split_into_flow (instance method)">- (Object) <strong>split_into_flow</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Splits the string into chunks by attribute change.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unmask_protected_sequences-instance_method" title="#unmask_protected_sequences (instance method)">- (Object) <strong>unmask_protected_sequences</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Unescapes special sequences of text.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="RDoc::Markup::AttributeManager (class)">AttributeManager</a></span></tt>) <strong>initialize</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Creates a new attribute manager that understands bold, emphasized and
teletype text.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 59</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span>
  <span class='ivar'>@html_tags</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@matching_word_pairs</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@protectable</span> <span class='op'>=</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>&lt;</span><span class='words_sep'>]</span>
  <span class='ivar'>@special</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@word_pair_map</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id add_word_pair'>add_word_pair</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:BOLD</span>
  <span class='id add_word_pair'>add_word_pair</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:EM</span>
  <span class='id add_word_pair'>add_word_pair</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:TT</span>

  <span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>em</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:EM</span>
  <span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>i</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>  <span class='symbol'>:EM</span>
  <span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>b</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>  <span class='symbol'>:BOLD</span>
  <span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='symbol'>:TT</span>
  <span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:TT</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="html_tags-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="html_tags-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>html_tags</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This maps HTML tags to the corresponding attribute char</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 41</span>

<span class='kw'>def</span> <span class='id html_tags'>html_tags</span>
  <span class='ivar'>@html_tags</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="matching_word_pairs-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="matching_word_pairs-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>matching_word_pairs</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This maps delimiters that occur around words (such as <b>bold</b> or
<tt>tt</tt>) where the start and end delimiters and the same. This lets us
optimize the regexp</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 30</span>

<span class='kw'>def</span> <span class='id matching_word_pairs'>matching_word_pairs</span>
  <span class='ivar'>@matching_word_pairs</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="protectable-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="protectable-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>protectable</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>A \ in front of a character that would normally be processed turns off
processing. We do this by turning &lt; into &lt;#PROTECT</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 47</span>

<span class='kw'>def</span> <span class='id protectable'>protectable</span>
  <span class='ivar'>@protectable</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="special-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="special-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>special</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>And this maps <em>special</em> sequences to a name. A special sequence is
something like a WikiWord</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 53</span>

<span class='kw'>def</span> <span class='id special'>special</span>
  <span class='ivar'>@special</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="word_pair_map-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="word_pair_map-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>word_pair_map</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>And this is used when the delimiters aren't the same. In this case the hash
maps a pattern to the attribute character</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 36</span>

<span class='kw'>def</span> <span class='id word_pair_map'>word_pair_map</span>
  <span class='ivar'>@word_pair_map</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="add_html-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_html</strong>(tag, name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds a markup class with <tt>name</tt> for words surrounded by HTML tag
<tt>tag</tt>. To process emphasis tags:</p>

<pre class="code"><span class='id am'>am</span><span class='period'>.</span><span class='id add_html'>add_html</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>em</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:EM</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 222</span>

<span class='kw'>def</span> <span class='id add_html'>add_html</span><span class='lparen'>(</span><span class='id tag'>tag</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@html_tags</span><span class='lbracket'>[</span><span class='id tag'>tag</span><span class='period'>.</span><span class='id downcase'>downcase</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='period'>.</span><span class='id bitmap_for'>bitmap_for</span> <span class='id name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_special-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_special</strong>(pattern, name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds a special handler for <tt>pattern</tt> with <tt>name</tt>.  A simple
URL handler would be:</p>

<pre class="code"><span class='ivar'>@am</span><span class='period'>.</span><span class='id add_special'>add_special</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>((https?:)\S+\w)</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='symbol'>:HYPERLINK</span><span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 232</span>

<span class='kw'>def</span> <span class='id add_special'>add_special</span><span class='lparen'>(</span><span class='id pattern'>pattern</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@special</span><span class='lbracket'>[</span><span class='id pattern'>pattern</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='period'>.</span><span class='id bitmap_for'>bitmap_for</span> <span class='id name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_word_pair-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_word_pair</strong>(start, stop, name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds a markup class with <tt>name</tt> for words wrapped in the
<tt>start</tt> and <tt>stop</tt> character.  To make words wrapped with "*"
bold:</p>

<pre class="code"><span class='id am'>am</span><span class='period'>.</span><span class='id add_word_pair'>add_word_pair</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='symbol'>:BOLD</span></pre>


  </div>
</div>
<div class="tags">
  <h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 199</span>

<span class='kw'>def</span> <span class='id add_word_pair'>add_word_pair</span><span class='lparen'>(</span><span class='id start'>start</span><span class='comma'>,</span> <span class='id stop'>stop</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='id raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Word flags may not start with '&lt;'</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span>
    <span class='id start'>start</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>'</span></span>

  <span class='id bitmap'>bitmap</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='period'>.</span><span class='id bitmap_for'>bitmap_for</span> <span class='id name'>name</span>

  <span class='kw'>if</span> <span class='id start'>start</span> <span class='op'>==</span> <span class='id stop'>stop</span> <span class='kw'>then</span>
    <span class='ivar'>@matching_word_pairs</span><span class='lbracket'>[</span><span class='id start'>start</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id bitmap'>bitmap</span>
  <span class='kw'>else</span>
    <span class='id pattern'>pattern</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id escape'>escape</span> <span class='id start'>start</span><span class='rbrace'>}</span><span class='tstring_content'>)(\S+)(</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id escape'>escape</span> <span class='id stop'>stop</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='regexp_end'>/</span></span>
    <span class='ivar'>@word_pair_map</span><span class='lbracket'>[</span><span class='id pattern'>pattern</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id bitmap'>bitmap</span>
  <span class='kw'>end</span>

  <span class='ivar'>@protectable</span> <span class='op'>&lt;&lt;</span> <span class='id start'>start</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='ivar'>@protectable</span><span class='period'>.</span><span class='id uniq!'>uniq!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attribute-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>attribute</strong>(turn_on, turn_off) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Return an attribute object with the given turn_on and turn_off bits set</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 80</span>

<span class='kw'>def</span> <span class='id attribute'>attribute</span><span class='lparen'>(</span><span class='id turn_on'>turn_on</span><span class='comma'>,</span> <span class='id turn_off'>turn_off</span><span class='rparen'>)</span>
  <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>AttrChanger</span><span class='period'>.</span><span class='id new'>new</span> <span class='id turn_on'>turn_on</span><span class='comma'>,</span> <span class='id turn_off'>turn_off</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="change_attribute-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>change_attribute</strong>(current, new) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Changes the current attribute from <tt>current</tt> to <tt>new</tt></p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 87</span>

<span class='kw'>def</span> <span class='id change_attribute'>change_attribute</span> <span class='id current'>current</span><span class='comma'>,</span> <span class='id new'>new</span>
  <span class='id diff'>diff</span> <span class='op'>=</span> <span class='id current'>current</span> <span class='op'>^</span> <span class='id new'>new</span>
  <span class='id attribute'>attribute</span><span class='lparen'>(</span><span class='id new'>new</span> <span class='op'>&amp;</span> <span class='id diff'>diff</span><span class='comma'>,</span> <span class='id current'>current</span> <span class='op'>&amp;</span> <span class='id diff'>diff</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="changed_attribute_by_name-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>changed_attribute_by_name</strong>(current_set, new_set) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Used by the tests to change attributes by name from <tt>current_set</tt> to
<tt>new_set</tt></p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 96</span>

<span class='kw'>def</span> <span class='id changed_attribute_by_name'>changed_attribute_by_name</span> <span class='id current_set'>current_set</span><span class='comma'>,</span> <span class='id new_set'>new_set</span>
  <span class='id current'>current</span> <span class='op'>=</span> <span class='id new'>new</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id current_set'>current_set</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span>
    <span class='id current'>current</span> <span class='op'>|=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='period'>.</span><span class='id bitmap_for'>bitmap_for</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id new_set'>new_set</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span>
    <span class='id new'>new</span> <span class='op'>|=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='period'>.</span><span class='id bitmap_for'>bitmap_for</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id change_attribute'>change_attribute</span><span class='lparen'>(</span><span class='id current'>current</span><span class='comma'>,</span> <span class='id new'>new</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="convert_attrs-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>convert_attrs</strong>(str, attrs) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Map attributes like <b>text</b>to the sequence
001002&lt;char&gt;001003&lt;char&gt;, where &lt;char&gt; is a per-attribute
specific character</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 123</span>

<span class='kw'>def</span> <span class='id convert_attrs'>convert_attrs</span><span class='lparen'>(</span><span class='id str'>str</span><span class='comma'>,</span> <span class='id attrs'>attrs</span><span class='rparen'>)</span>
  <span class='comment'># first do matching ones
</span>  <span class='id tags'>tags</span> <span class='op'>=</span> <span class='ivar'>@matching_word_pairs</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id re'>re</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(^|\W)([</span><span class='embexpr_beg'>#{</span><span class='id tags'>tags</span><span class='rbrace'>}</span><span class='tstring_content'>])([#:\\]?[\w.\/-]+?\S?)\2(\W|$)</span><span class='regexp_end'>/</span></span>

  <span class='int'>1</span> <span class='kw'>while</span> <span class='id str'>str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='id re'>re</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id attr'>attr</span> <span class='op'>=</span> <span class='ivar'>@matching_word_pairs</span><span class='lbracket'>[</span><span class='backref'>$2</span><span class='rbracket'>]</span>
    <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id set_attrs'>set_attrs</span><span class='lparen'>(</span><span class='backref'>$`</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$1</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='backref'>$3</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='id attr'>attr</span><span class='rparen'>)</span>
    <span class='backref'>$1</span> <span class='op'>+</span> <span class='const'>NULL</span> <span class='op'>*</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$3</span> <span class='op'>+</span> <span class='const'>NULL</span> <span class='op'>*</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$4</span>
  <span class='kw'>end</span>

  <span class='comment'># then non-matching
</span>  <span class='kw'>unless</span> <span class='ivar'>@word_pair_map</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='kw'>then</span>
    <span class='ivar'>@word_pair_map</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id regexp'>regexp</span><span class='comma'>,</span> <span class='id attr'>attr</span><span class='op'>|</span>
      <span class='id str'>str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='id regexp'>regexp</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
        <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id set_attrs'>set_attrs</span><span class='lparen'>(</span><span class='backref'>$`</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$1</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='id attr'>attr</span><span class='rparen'>)</span>
        <span class='const'>NULL</span> <span class='op'>*</span> <span class='backref'>$1</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='backref'>$2</span> <span class='op'>+</span> <span class='const'>NULL</span> <span class='op'>*</span> <span class='backref'>$3</span><span class='period'>.</span><span class='id length'>length</span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="convert_html-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>convert_html</strong>(str, attrs) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Converts HTML tags to RDoc attributes</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 149</span>

<span class='kw'>def</span> <span class='id convert_html'>convert_html</span><span class='lparen'>(</span><span class='id str'>str</span><span class='comma'>,</span> <span class='id attrs'>attrs</span><span class='rparen'>)</span>
  <span class='id tags'>tags</span> <span class='op'>=</span> <span class='ivar'>@html_tags</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id join'>join</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>|</span><span class='tstring_end'>'</span></span>

  <span class='int'>1</span> <span class='kw'>while</span> <span class='id str'>str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>&lt;(</span><span class='embexpr_beg'>#{</span><span class='id tags'>tags</span><span class='rbrace'>}</span><span class='tstring_content'>)&gt;(.*?)&lt;\/\1&gt;</span><span class='regexp_end'>/i</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span>
    <span class='id attr'>attr</span> <span class='op'>=</span> <span class='ivar'>@html_tags</span><span class='lbracket'>[</span><span class='backref'>$1</span><span class='period'>.</span><span class='id downcase'>downcase</span><span class='rbracket'>]</span>
    <span class='id html_length'>html_length</span> <span class='op'>=</span> <span class='backref'>$1</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='int'>2</span>
    <span class='id seq'>seq</span> <span class='op'>=</span> <span class='const'>NULL</span> <span class='op'>*</span> <span class='id html_length'>html_length</span>
    <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id set_attrs'>set_attrs</span><span class='lparen'>(</span><span class='backref'>$`</span><span class='period'>.</span><span class='id length'>length</span> <span class='op'>+</span> <span class='id html_length'>html_length</span><span class='comma'>,</span> <span class='backref'>$2</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='id attr'>attr</span><span class='rparen'>)</span>
    <span class='id seq'>seq</span> <span class='op'>+</span> <span class='backref'>$2</span> <span class='op'>+</span> <span class='id seq'>seq</span> <span class='op'>+</span> <span class='const'>NULL</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="convert_specials-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>convert_specials</strong>(str, attrs) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Converts special sequences to RDoc attributes</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166
167
168
169
170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 164</span>

<span class='kw'>def</span> <span class='id convert_specials'>convert_specials</span><span class='lparen'>(</span><span class='id str'>str</span><span class='comma'>,</span> <span class='id attrs'>attrs</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='ivar'>@special</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='ivar'>@special</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id regexp'>regexp</span><span class='comma'>,</span> <span class='id attr'>attr</span><span class='op'>|</span>
      <span class='id str'>str</span><span class='period'>.</span><span class='id scan'>scan</span><span class='lparen'>(</span><span class='id regexp'>regexp</span><span class='rparen'>)</span> <span class='kw'>do</span>
        <span class='id attrs'>attrs</span><span class='period'>.</span><span class='id set_attrs'>set_attrs</span><span class='lparen'>(</span><span class='backref'>$`</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='backref'>$&amp;</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span>
                        <span class='id attr'>attr</span> <span class='op'>|</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='op'>::</span><span class='const'>SPECIAL</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="copy_string-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>copy_string</strong>(start_pos, end_pos) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Copies <tt>start_pos</tt> to <tt>end_pos</tt> from the current string</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 112</span>

<span class='kw'>def</span> <span class='id copy_string'>copy_string</span><span class='lparen'>(</span><span class='id start_pos'>start_pos</span><span class='comma'>,</span> <span class='id end_pos'>end_pos</span><span class='rparen'>)</span>
  <span class='id res'>res</span> <span class='op'>=</span> <span class='ivar'>@str</span><span class='lbracket'>[</span><span class='id start_pos'>start_pos</span><span class='op'>...</span><span class='id end_pos'>end_pos</span><span class='rbracket'>]</span>
  <span class='id res'>res</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\000</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="display_attributes-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>display_attributes</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Debug method that prints a string along with its attributes</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 258</span>

<span class='kw'>def</span> <span class='id display_attributes'>display_attributes</span>
  <span class='id puts'>puts</span>
  <span class='id puts'>puts</span> <span class='ivar'>@str</span><span class='period'>.</span><span class='id tr'>tr</span><span class='lparen'>(</span><span class='const'>NULL</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id bit'>bit</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='int'>16</span><span class='period'>.</span><span class='id times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id bno'>bno</span><span class='op'>|</span>
    <span class='id line'>line</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@str</span><span class='period'>.</span><span class='id length'>length</span><span class='period'>.</span><span class='id times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id i'>i</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@attrs</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span> <span class='op'>&amp;</span> <span class='id bit'>bit</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='int'>0</span>
        <span class='id line'>line</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='id bno'>bno</span><span class='period'>.</span><span class='id zero?'>zero?</span>
          <span class='id line'>line</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id line'>line</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%d</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lparen'>(</span><span class='id bno'>bno</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id puts'>puts</span><span class='lparen'>(</span><span class='id line'>line</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id line'>line</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^ *$</span><span class='regexp_end'>/</span></span>
    <span class='id bit'>bit</span> <span class='op'>&lt;&lt;=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="flow-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>flow</strong>(str) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Processes <tt>str</tt> converting attributes, HTML and specials</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 239</span>

<span class='kw'>def</span> <span class='id flow'>flow</span><span class='lparen'>(</span><span class='id str'>str</span><span class='rparen'>)</span>
  <span class='ivar'>@str</span> <span class='op'>=</span> <span class='id str'>str</span>

  <span class='id mask_protected_sequences'>mask_protected_sequences</span>

  <span class='ivar'>@attrs</span> <span class='op'>=</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>AttrSpan</span><span class='period'>.</span><span class='id new'>new</span> <span class='ivar'>@str</span><span class='period'>.</span><span class='id length'>length</span>

  <span class='id convert_attrs'>convert_attrs</span>    <span class='ivar'>@str</span><span class='comma'>,</span> <span class='ivar'>@attrs</span>
  <span class='id convert_html'>convert_html</span>     <span class='ivar'>@str</span><span class='comma'>,</span> <span class='ivar'>@attrs</span>
  <span class='id convert_specials'>convert_specials</span> <span class='ivar'>@str</span><span class='comma'>,</span> <span class='ivar'>@attrs</span>

  <span class='id unmask_protected_sequences'>unmask_protected_sequences</span>

  <span class='id split_into_flow'>split_into_flow</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="mask_protected_sequences-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>mask_protected_sequences</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Escapes special sequences of text to prevent conversion to RDoc</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 178</span>

<span class='kw'>def</span> <span class='id mask_protected_sequences'>mask_protected_sequences</span>
  <span class='comment'># protect __send__, __FILE__, etc.
</span>  <span class='ivar'>@str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>__([a-z]+)__</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='tstring_content'>\\1_</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\\([</span><span class='embexpr_beg'>#{</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id escape'>escape</span> <span class='ivar'>@protectable</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>])</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
             <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\1</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="split_into_flow-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>split_into_flow</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Splits the string into chunks by attribute change</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 283</span>

<span class='kw'>def</span> <span class='id split_into_flow'>split_into_flow</span>
  <span class='id res'>res</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id current_attr'>current_attr</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id str_len'>str_len</span> <span class='op'>=</span> <span class='ivar'>@str</span><span class='period'>.</span><span class='id length'>length</span>

  <span class='comment'># skip leading invisible text
</span>  <span class='id i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id i'>i</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>while</span> <span class='id i'>i</span> <span class='op'>&lt;</span> <span class='id str_len'>str_len</span> <span class='kw'>and</span> <span class='ivar'>@str</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id chr'>chr</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\0</span><span class='tstring_end'>&quot;</span></span>
  <span class='id start_pos'>start_pos</span> <span class='op'>=</span> <span class='id i'>i</span>

  <span class='comment'># then scan the string, chunking it on attribute changes
</span>  <span class='kw'>while</span> <span class='id i'>i</span> <span class='op'>&lt;</span> <span class='id str_len'>str_len</span>
    <span class='id new_attr'>new_attr</span> <span class='op'>=</span> <span class='ivar'>@attrs</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id new_attr'>new_attr</span> <span class='op'>!=</span> <span class='id current_attr'>current_attr</span>
      <span class='kw'>if</span> <span class='id i'>i</span> <span class='op'>&gt;</span> <span class='id start_pos'>start_pos</span>
        <span class='id res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id copy_string'>copy_string</span><span class='lparen'>(</span><span class='id start_pos'>start_pos</span><span class='comma'>,</span> <span class='id i'>i</span><span class='rparen'>)</span>
        <span class='id start_pos'>start_pos</span> <span class='op'>=</span> <span class='id i'>i</span>
      <span class='kw'>end</span>

      <span class='id res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id change_attribute'>change_attribute</span><span class='lparen'>(</span><span class='id current_attr'>current_attr</span><span class='comma'>,</span> <span class='id new_attr'>new_attr</span><span class='rparen'>)</span>
      <span class='id current_attr'>current_attr</span> <span class='op'>=</span> <span class='id new_attr'>new_attr</span>

      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id current_attr'>current_attr</span> <span class='op'>&amp;</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='op'>::</span><span class='const'>SPECIAL</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span> <span class='kw'>then</span>
        <span class='id i'>i</span> <span class='op'>+=</span> <span class='int'>1</span> <span class='kw'>while</span>
          <span class='id i'>i</span> <span class='op'>&lt;</span> <span class='id str_len'>str_len</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='ivar'>@attrs</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span> <span class='op'>&amp;</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Attribute</span><span class='op'>::</span><span class='const'>SPECIAL</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='int'>0</span>

        <span class='id res'>res</span> <span class='op'>&lt;&lt;</span> <span class='const'>RDoc</span><span class='op'>::</span><span class='const'>Markup</span><span class='op'>::</span><span class='const'>Special</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id current_attr'>current_attr</span><span class='comma'>,</span>
                                         <span class='id copy_string'>copy_string</span><span class='lparen'>(</span><span class='id start_pos'>start_pos</span><span class='comma'>,</span> <span class='id i'>i</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id start_pos'>start_pos</span> <span class='op'>=</span> <span class='id i'>i</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># move on, skipping any invisible characters
</span>    <span class='kw'>begin</span>
      <span class='id i'>i</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span> <span class='kw'>while</span> <span class='id i'>i</span> <span class='op'>&lt;</span> <span class='id str_len'>str_len</span> <span class='kw'>and</span> <span class='ivar'>@str</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id chr'>chr</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\0</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># tidy up trailing text
</span>  <span class='kw'>if</span> <span class='id start_pos'>start_pos</span> <span class='op'>&lt;</span> <span class='id str_len'>str_len</span>
    <span class='id res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id copy_string'>copy_string</span><span class='lparen'>(</span><span class='id start_pos'>start_pos</span><span class='comma'>,</span> <span class='id str_len'>str_len</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># and reset to all attributes off
</span>  <span class='id res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id change_attribute'>change_attribute</span><span class='lparen'>(</span><span class='id current_attr'>current_attr</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id current_attr'>current_attr</span> <span class='op'>!=</span> <span class='int'>0</span>

  <span class='id res'>res</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="unmask_protected_sequences-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>unmask_protected_sequences</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Unescapes special sequences of text</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rdoc/markup/attribute_manager.rb', line 189</span>

<span class='kw'>def</span> <span class='id unmask_protected_sequences'>unmask_protected_sequences</span>
  <span class='ivar'>@str</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(.)</span><span class='embexpr_beg'>#{</span><span class='const'>PROTECT_ATTR</span><span class='rbrace'>}</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\\1\000</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Sep  3 14:11:46 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.3).
</div>

  </body>
</html>