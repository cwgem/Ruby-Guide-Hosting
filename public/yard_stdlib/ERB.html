<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: ERB
  
    &mdash; Ruby 1.9 Ruby Standard Library
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (E)</a> &raquo; 
    
    
    <span class="title">ERB</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: ERB
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">ERB</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/erb.rb<span class="defines">,<br />
  lib/erb.rb,<br /> lib/erb.rb,<br /> lib/erb.rb,<br /> lib/erb.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>-- ERB::DefMethod</p>


  </div>
</div>
<div class="tags">
  
</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="ERB/DefMethod.html" title="ERB::DefMethod (module)">DefMethod</a></span>, <span class='object_link'><a href="ERB/Util.html" title="ERB::Util (module)">Util</a></span>
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="ERB/Compiler.html" title="ERB::Compiler (class)">Compiler</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="Revision-constant" class="">Revision =
          <div class="docstring">
  <div class="discussion">
    
<p>'</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>$Date:: 2011-05-25 08:24:32 +0900#$</span><span class='tstring_end'>'</span></span></pre></dd>
      
    </dl>
  


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#filename-instance_method" title="#filename (instance method)">- (Object) <strong>filename</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The optional <em>filename</em> argument passed to Kernel#eval when the ERB
code is run.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#src-instance_method" title="#src (instance method)">- (Object) <strong>src</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The Ruby code generated by ERB.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-class_method" title="version (class method)">+ (Object) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns revision information for the erb.rb module.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#def_class-instance_method" title="#def_class (instance method)">- (Object) <strong>def_class</strong>(superklass = Object, methodname = 'result') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define unnamed class which has <em>methodname</em> as instance method, and
return it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#def_method-instance_method" title="#def_method (instance method)">- (Object) <strong>def_method</strong>(mod, methodname, fname = '(ERB)') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define <em>methodname</em> as instance method of <em>mod</em> from compiled
ruby source.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#def_module-instance_method" title="#def_module (instance method)">- (Object) <strong>def_module</strong>(methodname = 'erb') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create unnamed module, define <em>methodname</em> as instance method of it,
and return it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ERB) <strong>initialize</strong>(str, safe_level = nil, trim_mode = nil, eoutvar = '_erbout') </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Constructs a new ERB object with the template specified in <em>str</em>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#result-instance_method" title="#result (instance method)">- (Object) <strong>result</strong>(b = TOPLEVEL_BINDING) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Executes the generated ERB code to produce a completed template, returning
the results of that code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">- (Object) <strong>run</strong>(b = TOPLEVEL_BINDING) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate results and print them.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_eoutvar-instance_method" title="#set_eoutvar (instance method)">- (Object) <strong>set_eoutvar</strong>(compiler, eoutvar = '_erbout') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Can be used to set <em>eoutvar</em> as described in ERB#new.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="ERB (class)">ERB</a></span></tt>) <strong>initialize</strong>(str, safe_level = nil, trim_mode = nil, eoutvar = '_erbout') 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Constructs a new ERB object with the template specified in <em>str</em>.</p>

<p>An ERB object works by building a chunk of Ruby code that will output the
completed template when run. If <em>safe_level</em> is set to a non-nil
value, ERB code will be run in a separate thread with <b>$SAFE</b> set to
the provided level.</p>

<p>If <em>trim_mode</em> is passed a String containing one or more of the
following modifiers, ERB will adjust its code generation as listed:</p>

<pre class="code">%  enables Ruby code processing for lines beginning with %
&lt;&gt; omit newline for lines starting with &lt;% and ending in %&gt;
&gt;  omit newline for lines ending in %&gt;</pre>

<p><em>eoutvar</em> can be used to set the name of the variable ERB will build
up its output in.  This is useful when you need to run multiple ERB
templates through the same binding and/or when you want to control where
output ends up.  Pass the name of the variable to be used inside a String.</p>

<h3>Example</h3>

<pre class="code"><span class='id require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>erb</span><span class='tstring_end'>&quot;</span></span>

<span class='comment'># build data class
</span><span class='kw'>class</span> <span class='const'>Listings</span>
  <span class='const'>PRODUCT</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Chicken Fried Steak</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
              <span class='symbol'>:desc</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A well messages pattie, breaded and fried.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
              <span class='symbol'>:cost</span> <span class='op'>=&gt;</span> <span class='float'>9.95</span> <span class='rbrace'>}</span>

  <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:product</span><span class='comma'>,</span> <span class='symbol'>:price</span>

  <span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span> <span class='id product'>product</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id price'>price</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@product</span> <span class='op'>=</span> <span class='id product'>product</span>
    <span class='ivar'>@price</span> <span class='op'>=</span> <span class='id price'>price</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id build'>build</span>
    <span class='id b'>b</span> <span class='op'>=</span> <span class='id binding'>binding</span>
    <span class='comment'># create and run templates, filling member data variables
</span>    <span class='const'>ERB</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-'END_PRODUCT'</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@product</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id result'>result</span> <span class='id b'>b</span>
<span class='tstring_content'>      &lt;%= PRODUCT[:name] %&gt;
      &lt;%= PRODUCT[:desc] %&gt;
</span><span class='heredoc_end'>    END_PRODUCT
</span>    <span class='const'>ERB</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='heredoc_beg'>&lt;&lt;-'END_PRICE'</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@price</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id result'>result</span> <span class='id b'>b</span>
<span class='tstring_content'>      &lt;%= PRODUCT[:name] %&gt; -- &lt;%= PRODUCT[:cost] %&gt;
      &lt;%= PRODUCT[:desc] %&gt;
</span><span class='heredoc_end'>    END_PRICE
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='comment'># setup template data
</span><span class='id listings'>listings</span> <span class='op'>=</span> <span class='const'>Listings</span><span class='period'>.</span><span class='id new'>new</span>
<span class='id listings'>listings</span><span class='period'>.</span><span class='id build'>build</span>

<span class='id puts'>puts</span> <span class='id listings'>listings</span><span class='period'>.</span><span class='id product'>product</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id listings'>listings</span><span class='period'>.</span><span class='id price'>price</span></pre>

<p><em>Generates</em></p>

<pre class="code">Chicken Fried Steak
A well messages pattie, breaded and fried.

Chicken Fried Steak -- 9.95
A well messages pattie, breaded and fried.</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


783
784
785
786
787
788
789</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 783</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id str'>str</span><span class='comma'>,</span> <span class='id safe_level'>safe_level</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id trim_mode'>trim_mode</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id eoutvar'>eoutvar</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_erbout</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='ivar'>@safe_level</span> <span class='op'>=</span> <span class='id safe_level'>safe_level</span>
  <span class='id compiler'>compiler</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='op'>::</span><span class='const'>Compiler</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id trim_mode'>trim_mode</span><span class='rparen'>)</span>
  <span class='id set_eoutvar'>set_eoutvar</span><span class='lparen'>(</span><span class='id compiler'>compiler</span><span class='comma'>,</span> <span class='id eoutvar'>eoutvar</span><span class='rparen'>)</span>
  <span class='ivar'>@src</span><span class='comma'>,</span> <span class='ivar'>@enc</span> <span class='op'>=</span> <span class='op'>*</span><span class='id compiler'>compiler</span><span class='period'>.</span><span class='id compile'>compile</span><span class='lparen'>(</span><span class='id str'>str</span><span class='rparen'>)</span>
  <span class='ivar'>@filename</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="filename=-instance_method"></span>
      <span id="filename-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="filename-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>filename</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>The optional <em>filename</em> argument passed to Kernel#eval when the ERB
code is run</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


796
797
798</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 796</span>

<span class='kw'>def</span> <span class='id filename'>filename</span>
  <span class='ivar'>@filename</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="src-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="src-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>src</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>The Ruby code generated by ERB</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


792
793
794</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 792</span>

<span class='kw'>def</span> <span class='id src'>src</span>
  <span class='ivar'>@src</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="version-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>version</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns revision information for the erb.rb module.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


260
261
262</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 260</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id version'>version</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>erb.rb [2.1.0 </span><span class='embexpr_beg'>#{</span><span class='const'>ERB</span><span class='op'>::</span><span class='const'>Revision</span><span class='period'>.</span><span class='id split'>split</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="def_class-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>def_class</strong>(superklass = Object, methodname = 'result') 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Define unnamed class which has <em>methodname</em> as instance method, and
return it.</p>

<p>example:</p>

<pre class="code"><span class='kw'>class</span> <span class='const'>MyClass_</span>
  <span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id arg1'>arg1</span><span class='comma'>,</span> <span class='id arg2'>arg2</span><span class='rparen'>)</span>
    <span class='ivar'>@arg1</span> <span class='op'>=</span> <span class='id arg1'>arg1</span><span class='semicolon'>;</span>  <span class='ivar'>@arg2</span> <span class='op'>=</span> <span class='id arg2'>arg2</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='id filename'>filename</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>example.rhtml</span><span class='tstring_end'>'</span></span>  <span class='comment'># @arg1 and @arg2 are used in example.rhtml
</span><span class='id erb'>erb</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id erb'>erb</span><span class='period'>.</span><span class='id filename'>filename</span> <span class='op'>=</span> <span class='id filename'>filename</span>
<span class='const'>MyClass</span> <span class='op'>=</span> <span class='id erb'>erb</span><span class='period'>.</span><span class='id def_class'>def_class</span><span class='lparen'>(</span><span class='const'>MyClass_</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>render()</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='id print'>print</span> <span class='const'>MyClass</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>foo</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>123</span><span class='rparen'>)</span><span class='period'>.</span><span class='id render'>render</span><span class='lparen'>(</span><span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


886
887
888
889
890</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 886</span>

<span class='kw'>def</span> <span class='id def_class'>def_class</span><span class='lparen'>(</span><span class='id superklass'>superklass</span><span class='op'>=</span><span class='const'>Object</span><span class='comma'>,</span> <span class='id methodname'>methodname</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>result</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id cls'>cls</span> <span class='op'>=</span> <span class='const'>Class</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id superklass'>superklass</span><span class='rparen'>)</span>
  <span class='id def_method'>def_method</span><span class='lparen'>(</span><span class='id cls'>cls</span><span class='comma'>,</span> <span class='id methodname'>methodname</span><span class='comma'>,</span> <span class='ivar'>@filename</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(ERB)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id cls'>cls</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="def_method-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>def_method</strong>(mod, methodname, fname = '(ERB)') 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Define <em>methodname</em> as instance method of <em>mod</em> from compiled
ruby source.</p>

<p>example:</p>

<pre class="code"><span class='id filename'>filename</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>example.rhtml</span><span class='tstring_end'>'</span></span>   <span class='comment'># 'arg1' and 'arg2' are used in example.rhtml
</span><span class='id erb'>erb</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id erb'>erb</span><span class='period'>.</span><span class='id def_method'>def_method</span><span class='lparen'>(</span><span class='const'>MyClass</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>render(arg1, arg2)</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id filename'>filename</span><span class='rparen'>)</span>
<span class='id print'>print</span> <span class='const'>MyClass</span><span class='period'>.</span><span class='id new'>new</span><span class='period'>.</span><span class='id render'>render</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>foo</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>123</span><span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


849
850
851
852
853
854
855</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 849</span>

<span class='kw'>def</span> <span class='id def_method'>def_method</span><span class='lparen'>(</span><span class='id mod'>mod</span><span class='comma'>,</span> <span class='id methodname'>methodname</span><span class='comma'>,</span> <span class='id fname'>fname</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(ERB)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id src'>src</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id src'>src</span>
  <span class='id magic_comment'>magic_comment</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#coding:</span><span class='embexpr_beg'>#{</span><span class='ivar'>@enc</span><span class='rbrace'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id mod'>mod</span><span class='period'>.</span><span class='id module_eval'>module_eval</span> <span class='kw'>do</span>
    <span class='id eval'>eval</span><span class='lparen'>(</span><span class='id magic_comment'>magic_comment</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>def </span><span class='embexpr_beg'>#{</span><span class='id methodname'>methodname</span><span class='rbrace'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id src'>src</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nend\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id binding'>binding</span><span class='comma'>,</span> <span class='id fname'>fname</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>2</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="def_module-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>def_module</strong>(methodname = 'erb') 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Create unnamed module, define <em>methodname</em> as instance method of it,
and return it.</p>

<p>example:</p>

<pre class="code"><span class='id filename'>filename</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>example.rhtml</span><span class='tstring_end'>'</span></span>   <span class='comment'># 'arg1' and 'arg2' are used in example.rhtml
</span><span class='id erb'>erb</span> <span class='op'>=</span> <span class='const'>ERB</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='id erb'>erb</span><span class='period'>.</span><span class='id filename'>filename</span> <span class='op'>=</span> <span class='id filename'>filename</span>
<span class='const'>MyModule</span> <span class='op'>=</span> <span class='id erb'>erb</span><span class='period'>.</span><span class='id def_module'>def_module</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>render(arg1, arg2)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='kw'>class</span> <span class='const'>MyClass</span>
  <span class='id include'>include</span> <span class='const'>MyModule</span>
<span class='kw'>end</span></pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


867
868
869
870
871</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 867</span>

<span class='kw'>def</span> <span class='id def_module'>def_module</span><span class='lparen'>(</span><span class='id methodname'>methodname</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>erb</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id mod'>mod</span> <span class='op'>=</span> <span class='const'>Module</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='id def_method'>def_method</span><span class='lparen'>(</span><span class='id mod'>mod</span><span class='comma'>,</span> <span class='id methodname'>methodname</span><span class='comma'>,</span> <span class='ivar'>@filename</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(ERB)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id mod'>mod</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="result-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>result</strong>(b = TOPLEVEL_BINDING) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Executes the generated ERB code to produce a completed template, returning
the results of that code.  (See ERB#new for details on how this process can
be affected by <em>safe_level</em>.)</p>

<p><em>b</em> accepts a Binding or Proc object which is used to set the
context of code evaluation.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


831
832
833
834
835
836
837
838
839
840</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 831</span>

<span class='kw'>def</span> <span class='id result'>result</span><span class='lparen'>(</span><span class='id b'>b</span><span class='op'>=</span><span class='const'>TOPLEVEL_BINDING</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@safe_level</span>
    <span class='id proc'>proc</span> <span class='lbrace'>{</span>
      <span class='gvar'>$SAFE</span> <span class='op'>=</span> <span class='ivar'>@safe_level</span>
      <span class='id eval'>eval</span><span class='lparen'>(</span><span class='ivar'>@src</span><span class='comma'>,</span> <span class='id b'>b</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='ivar'>@filename</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(erb)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id call'>call</span>
  <span class='kw'>else</span>
    <span class='id eval'>eval</span><span class='lparen'>(</span><span class='ivar'>@src</span><span class='comma'>,</span> <span class='id b'>b</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='ivar'>@filename</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(erb)</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>run</strong>(b = TOPLEVEL_BINDING) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Generate results and print them. (see ERB#result)</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


819
820
821</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 819</span>

<span class='kw'>def</span> <span class='id run'>run</span><span class='lparen'>(</span><span class='id b'>b</span><span class='op'>=</span><span class='const'>TOPLEVEL_BINDING</span><span class='rparen'>)</span>
  <span class='id print'>print</span> <span class='kw'>self</span><span class='period'>.</span><span class='id result'>result</span><span class='lparen'>(</span><span class='id b'>b</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="set_eoutvar-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_eoutvar</strong>(compiler, eoutvar = '_erbout') 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Can be used to set <em>eoutvar</em> as described in ERB#new.  It's probably
easier to just use the constructor though, since calling this method
requires the setup of an ERB <em>compiler</em> object.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


803
804
805
806
807
808
809
810
811
812
813
814
815
816</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/erb.rb', line 803</span>

<span class='kw'>def</span> <span class='id set_eoutvar'>set_eoutvar</span><span class='lparen'>(</span><span class='id compiler'>compiler</span><span class='comma'>,</span> <span class='id eoutvar'>eoutvar</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_erbout</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
  <span class='id compiler'>compiler</span><span class='period'>.</span><span class='id put_cmd'>put_cmd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id eoutvar'>eoutvar</span><span class='rbrace'>}</span><span class='tstring_content'>.concat</span><span class='tstring_end'>&quot;</span></span>
  <span class='id compiler'>compiler</span><span class='period'>.</span><span class='id insert_cmd'>insert_cmd</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id eoutvar'>eoutvar</span><span class='rbrace'>}</span><span class='tstring_content'>.concat</span><span class='tstring_end'>&quot;</span></span>

  <span class='id cmd'>cmd</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id cmd'>cmd</span><span class='period'>.</span><span class='id push'>push</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id eoutvar'>eoutvar</span><span class='rbrace'>}</span><span class='tstring_content'> = ''</span><span class='tstring_end'>&quot;</span></span>

  <span class='id compiler'>compiler</span><span class='period'>.</span><span class='id pre_cmd'>pre_cmd</span> <span class='op'>=</span> <span class='id cmd'>cmd</span>

  <span class='id cmd'>cmd</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id cmd'>cmd</span><span class='period'>.</span><span class='id push'>push</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id eoutvar'>eoutvar</span><span class='rbrace'>}</span><span class='tstring_content'>.force_encoding(__ENCODING__)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id compiler'>compiler</span><span class='period'>.</span><span class='id post_cmd'>post_cmd</span> <span class='op'>=</span> <span class='id cmd'>cmd</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Sep  3 14:09:55 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.3).
</div>

  </body>
</html>