<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: PrettyPrint
  
    &mdash; Ruby 1.9 Ruby Standard Library
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (P)</a> &raquo; 
    
    
    <span class="title">PrettyPrint</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: PrettyPrint
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">PrettyPrint</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/prettyprint.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class implements a pretty printing algorithm. It finds line breaks and
nice indentations for grouped structure.</p>

<p>By default, the class assumes that primitive elements are strings and each
byte in the strings have single column in width. But it can be used for
other situations by giving suitable arguments for some methods:</p>
<ul><li>
<p>newline object and space generation block for PrettyPrint.new</p>
</li><li>
<p>optional width argument for PrettyPrint#text</p>
</li><li>
<p>PrettyPrint#breakable</p>
</li></ul>

<p>There are several candidate uses:</p>
<ul><li>
<p>text formatting using proportional fonts</p>
</li><li>
<p>multibyte characters which has columns different to number of bytes</p>
</li><li>
<p>non-string formatting</p>
</li></ul>

<h2>Bugs</h2>
<ul><li>
<p>Box based formatting?</p>
</li><li>
<p>Other (better) model/algorithm?</p>
</li></ul>

<h2>References</h2>

<p>Christian Lindig, Strictly Pretty, March 2000, <a
href="http://www.st.cs.uni-sb.de/~lindig/papers/#pretty">www.st.cs.uni-sb.de/~lindig/papers/#pretty</a></p>

<p>Philip Wadler, A prettier printer, March 1998, <a
href="http://homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier">homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier</a></p>

<h2>Author</h2>

<p>Tanaka Akira &lt;akr@m17n.org&gt;</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="PP.html" title="PP (class)">PP</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="PrettyPrint/Breakable.html" title="PrettyPrint::Breakable (class)">Breakable</a></span>, <span class='object_link'><a href="PrettyPrint/Group.html" title="PrettyPrint::Group (class)">Group</a></span>, <span class='object_link'><a href="PrettyPrint/GroupQueue.html" title="PrettyPrint::GroupQueue (class)">GroupQueue</a></span>, <span class='object_link'><a href="PrettyPrint/SingleLine.html" title="PrettyPrint::SingleLine (class)">SingleLine</a></span>, <span class='object_link'><a href="PrettyPrint/Text.html" title="PrettyPrint::Text (class)">Text</a></span>
    
  
</p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#genspace-instance_method" title="#genspace (instance method)">- (Object) <strong>genspace</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute genspace.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#group_queue-instance_method" title="#group_queue (instance method)">- (Object) <strong>group_queue</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute group_queue.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#indent-instance_method" title="#indent (instance method)">- (Object) <strong>indent</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute indent.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#maxwidth-instance_method" title="#maxwidth (instance method)">- (Object) <strong>maxwidth</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute maxwidth.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#newline-instance_method" title="#newline (instance method)">- (Object) <strong>newline</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute newline.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#output-instance_method" title="#output (instance method)">- (Object) <strong>output</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute output.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#format-class_method" title="format (class method)">+ (Object) <strong>format</strong>(output = '', maxwidth = 79, newline = &quot;\n&quot;, genspace = lambda {|n| ' ' * n}) {|q| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is a convenience method which is same as follows:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#singleline_format-class_method" title="singleline_format (class method)">+ (Object) <strong>singleline_format</strong>(output = '', maxwidth = nil, newline = nil, genspace = nil) {|q| ... }</a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is similar to PrettyPrint::format but the result has no breaks.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#break_outmost_groups-instance_method" title="#break_outmost_groups (instance method)">- (Object) <strong>break_outmost_groups</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Breaks the buffer into lines that are shorter than #maxwidth.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#breakable-instance_method" title="#breakable (instance method)">- (Object) <strong>breakable</strong>(sep = ' ', width = sep.length) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This says "you can break a line here if necessary", and a
<tt>width</tt>-column text <tt>sep</tt> is inserted if a line is not broken
at the point.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_group-instance_method" title="#current_group (instance method)">- (Object) <strong>current_group</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the group most recently added to the stack.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fill_breakable-instance_method" title="#fill_breakable (instance method)">- (Object) <strong>fill_breakable</strong>(sep = ' ', width = sep.length) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is similar to #breakable, but is less-likely to insert a newline.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#first%3F-instance_method" title="#first? (instance method)">- (Boolean) <strong>first?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>first? is a predicate to test the call is a first call to first? with
current group.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush-instance_method" title="#flush (instance method)">- (Object) <strong>flush</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>outputs buffered data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group-instance_method" title="#group (instance method)">- (Object) <strong>group</strong>(indent = 0, open_obj = '', close_obj = '', open_width = open_obj.length, close_width = close_obj.length) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Groups line break hints added in the block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#group_sub-instance_method" title="#group_sub (instance method)">- (Object) <strong>group_sub</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (PrettyPrint) <strong>initialize</strong>(output = '', maxwidth = 79, newline = &quot;\n&quot;, &amp;genspace) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a buffer for pretty printing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#nest-instance_method" title="#nest (instance method)">- (Object) <strong>nest</strong>(indent) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Increases left margin after newline with <tt>indent</tt> for line breaks
added in the block.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#text-instance_method" title="#text (instance method)">- (Object) <strong>text</strong>(obj, width = obj.length) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This adds <tt>obj</tt> as a text of <tt>width</tt> columns in width.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="PrettyPrint (class)">PrettyPrint</a></span></tt>) <strong>initialize</strong>(output = '', maxwidth = 79, newline = &quot;\n&quot;, &amp;genspace) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Creates a buffer for pretty printing.</p>

<p><tt>output</tt> is an output target. If it is not specified, " is assumed.
It should have a &lt;&lt; method which accepts the first argument
<tt>obj</tt> of PrettyPrint#text, the first argument <tt>sep</tt> of
PrettyPrint#breakable, the first argument <tt>newline</tt> of
PrettyPrint.new, and the result of a given block for PrettyPrint.new.</p>

<p><tt>maxwidth</tt> specifies maximum line length. If it is not specified, 79
is assumed. However actual outputs may overflow <tt>maxwidth</tt> if long
non-breakable texts are provided.</p>

<p><tt>newline</tt> is used for line breaks. "n" is used if it is not
specified.</p>

<p>The block is used to generate spaces. {|width| ' ' * width} is used if it
is not given.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84
85
86
87
88
89
90
91
92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 78</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id output'>output</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id maxwidth'>maxwidth</span><span class='op'>=</span><span class='int'>79</span><span class='comma'>,</span> <span class='id newline'>newline</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id genspace'>genspace</span><span class='rparen'>)</span>
  <span class='ivar'>@output</span> <span class='op'>=</span> <span class='id output'>output</span>
  <span class='ivar'>@maxwidth</span> <span class='op'>=</span> <span class='id maxwidth'>maxwidth</span>
  <span class='ivar'>@newline</span> <span class='op'>=</span> <span class='id newline'>newline</span>
  <span class='ivar'>@genspace</span> <span class='op'>=</span> <span class='id genspace'>genspace</span> <span class='op'>||</span> <span class='id lambda'>lambda</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id n'>n</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> </span><span class='tstring_end'>'</span></span> <span class='op'>*</span> <span class='id n'>n</span><span class='rbrace'>}</span>

  <span class='ivar'>@output_width</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@buffer_width</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@buffer</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id root_group'>root_group</span> <span class='op'>=</span> <span class='const'>Group</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='ivar'>@group_stack</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id root_group'>root_group</span><span class='rbracket'>]</span>
  <span class='ivar'>@group_queue</span> <span class='op'>=</span> <span class='const'>GroupQueue</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id root_group'>root_group</span><span class='rparen'>)</span>
  <span class='ivar'>@indent</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="genspace-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="genspace-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>genspace</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute genspace</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 93</span>

<span class='kw'>def</span> <span class='id genspace'>genspace</span>
  <span class='ivar'>@genspace</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="group_queue-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="group_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>group_queue</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute group_queue</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 94</span>

<span class='kw'>def</span> <span class='id group_queue'>group_queue</span>
  <span class='ivar'>@group_queue</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="indent-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="indent-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>indent</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute indent</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 94</span>

<span class='kw'>def</span> <span class='id indent'>indent</span>
  <span class='ivar'>@indent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="maxwidth-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="maxwidth-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>maxwidth</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute maxwidth</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 93</span>

<span class='kw'>def</span> <span class='id maxwidth'>maxwidth</span>
  <span class='ivar'>@maxwidth</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="newline-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="newline-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>newline</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute newline</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 93</span>

<span class='kw'>def</span> <span class='id newline'>newline</span>
  <span class='ivar'>@newline</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="output-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="output-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>output</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute output</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 93</span>

<span class='kw'>def</span> <span class='id output'>output</span>
  <span class='ivar'>@output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="format-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>format</strong>(output = '', maxwidth = 79, newline = &quot;\n&quot;, genspace = lambda {|n| ' ' * n}) {|q| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This is a convenience method which is same as follows:</p>

<pre class="code">begin
  q = PrettyPrint.new(output, maxwidth, newline, &amp;genspace)
  ...
  q.flush
  output
end</pre>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>q</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 41</span>

<span class='kw'>def</span> <span class='const'>PrettyPrint</span><span class='period'>.</span><span class='id format'>format</span><span class='lparen'>(</span><span class='id output'>output</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id maxwidth'>maxwidth</span><span class='op'>=</span><span class='int'>79</span><span class='comma'>,</span> <span class='id newline'>newline</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id genspace'>genspace</span><span class='op'>=</span><span class='id lambda'>lambda</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id n'>n</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> </span><span class='tstring_end'>'</span></span> <span class='op'>*</span> <span class='id n'>n</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id q'>q</span> <span class='op'>=</span> <span class='const'>PrettyPrint</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id output'>output</span><span class='comma'>,</span> <span class='id maxwidth'>maxwidth</span><span class='comma'>,</span> <span class='id newline'>newline</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id genspace'>genspace</span><span class='rparen'>)</span>
  <span class='kw'>yield</span> <span class='id q'>q</span>
  <span class='id q'>q</span><span class='period'>.</span><span class='id flush'>flush</span>
  <span class='id output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="singleline_format-class_method">
  
    + (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>singleline_format</strong>(output = '', maxwidth = nil, newline = nil, genspace = nil) {|q| ... }
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This is similar to PrettyPrint::format but the result has no breaks.</p>

<p><tt>maxwidth</tt>, <tt>newline</tt> and <tt>genspace</tt> are ignored.</p>

<p>The invocation of <tt>breakable</tt> in the block doesn't break a line and
is treated as just an invocation of <tt>text</tt>.</p>


  </div>
</div>
<div class="tags">
  <h3>Yields:</h3>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>q</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 55</span>

<span class='kw'>def</span> <span class='const'>PrettyPrint</span><span class='period'>.</span><span class='id singleline_format'>singleline_format</span><span class='lparen'>(</span><span class='id output'>output</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id maxwidth'>maxwidth</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id newline'>newline</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id genspace'>genspace</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id q'>q</span> <span class='op'>=</span> <span class='const'>SingleLine</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id output'>output</span><span class='rparen'>)</span>
  <span class='kw'>yield</span> <span class='id q'>q</span>
  <span class='id output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="break_outmost_groups-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>break_outmost_groups</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Breaks the buffer into lines that are shorter than #maxwidth</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127
128
129
130
131
132
133
134
135
136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 124</span>

<span class='kw'>def</span> <span class='id break_outmost_groups'>break_outmost_groups</span>
  <span class='kw'>while</span> <span class='ivar'>@maxwidth</span> <span class='op'>&lt;</span> <span class='ivar'>@output_width</span> <span class='op'>+</span> <span class='ivar'>@buffer_width</span>
    <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id group'>group</span> <span class='op'>=</span> <span class='ivar'>@group_queue</span><span class='period'>.</span><span class='id deq'>deq</span>
    <span class='kw'>until</span> <span class='id group'>group</span><span class='period'>.</span><span class='id breakables'>breakables</span><span class='period'>.</span><span class='id empty?'>empty?</span>
      <span class='id data'>data</span> <span class='op'>=</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id shift'>shift</span>
      <span class='ivar'>@output_width</span> <span class='op'>=</span> <span class='id data'>data</span><span class='period'>.</span><span class='id output'>output</span><span class='lparen'>(</span><span class='ivar'>@output</span><span class='comma'>,</span> <span class='ivar'>@output_width</span><span class='rparen'>)</span>
      <span class='ivar'>@buffer_width</span> <span class='op'>-=</span> <span class='id data'>data</span><span class='period'>.</span><span class='id width'>width</span>
    <span class='kw'>end</span>
    <span class='kw'>while</span> <span class='op'>!</span><span class='ivar'>@buffer</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='const'>Text</span> <span class='op'>===</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id first'>first</span>
      <span class='id text'>text</span> <span class='op'>=</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id shift'>shift</span>
      <span class='ivar'>@output_width</span> <span class='op'>=</span> <span class='id text'>text</span><span class='period'>.</span><span class='id output'>output</span><span class='lparen'>(</span><span class='ivar'>@output</span><span class='comma'>,</span> <span class='ivar'>@output_width</span><span class='rparen'>)</span>
      <span class='ivar'>@buffer_width</span> <span class='op'>-=</span> <span class='id text'>text</span><span class='period'>.</span><span class='id width'>width</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="breakable-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>breakable</strong>(sep = ' ', width = sep.length) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This says "you can break a line here if necessary", and a
<tt>width</tt>-column text <tt>sep</tt> is inserted if a line is not broken
at the point.</p>

<p>If <tt>sep</tt> is not specified, " " is used.</p>

<p>If <tt>width</tt> is not specified, <tt>sep.length</tt> is used. You will
have to specify this when <tt>sep</tt> is a multibyte character, for
example.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


181
182
183
184
185
186
187
188
189
190
191
192
193
194</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 181</span>

<span class='kw'>def</span> <span class='id breakable'>breakable</span><span class='lparen'>(</span><span class='id sep'>sep</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> </span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id width'>width</span><span class='op'>=</span><span class='id sep'>sep</span><span class='period'>.</span><span class='id length'>length</span><span class='rparen'>)</span>
  <span class='id group'>group</span> <span class='op'>=</span> <span class='ivar'>@group_stack</span><span class='period'>.</span><span class='id last'>last</span>
  <span class='kw'>if</span> <span class='id group'>group</span><span class='period'>.</span><span class='id break?'>break?</span>
    <span class='id flush'>flush</span>
    <span class='ivar'>@output</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@newline</span>
    <span class='ivar'>@output</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@genspace</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span><span class='ivar'>@indent</span><span class='rparen'>)</span>
    <span class='ivar'>@output_width</span> <span class='op'>=</span> <span class='ivar'>@indent</span>
    <span class='ivar'>@buffer_width</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>else</span>
    <span class='ivar'>@buffer</span> <span class='op'>&lt;&lt;</span> <span class='const'>Breakable</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id sep'>sep</span><span class='comma'>,</span> <span class='id width'>width</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@buffer_width</span> <span class='op'>+=</span> <span class='id width'>width</span>
    <span class='id break_outmost_groups'>break_outmost_groups</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="current_group-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>current_group</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the group most recently added to the stack.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 97</span>

<span class='kw'>def</span> <span class='id current_group'>current_group</span>
  <span class='ivar'>@group_stack</span><span class='period'>.</span><span class='id last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="fill_breakable-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>fill_breakable</strong>(sep = ' ', width = sep.length) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This is similar to #breakable, but is less-likely to insert a newline.</p>

<p>The text sep+ is inserted if a line is not broken at this point.</p>

<p>If <tt>sep</tt> is not specified, " " is used.</p>

<p>If <tt>width</tt> is not specified, <tt>sep.length</tt> is used. You will
have to specify this when <tt>sep</tt> is a multibyte character, for
example.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 169</span>

<span class='kw'>def</span> <span class='id fill_breakable'>fill_breakable</span><span class='lparen'>(</span><span class='id sep'>sep</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> </span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id width'>width</span><span class='op'>=</span><span class='id sep'>sep</span><span class='period'>.</span><span class='id length'>length</span><span class='rparen'>)</span>
  <span class='id group'>group</span> <span class='lbrace'>{</span> <span class='id breakable'>breakable</span> <span class='id sep'>sep</span><span class='comma'>,</span> <span class='id width'>width</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="first?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>first?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>first? is a predicate to test the call is a first call to first? with
current group.</p>

<p>It is useful to format comma separated values as:</p>

<pre class="code">q.group(1, '[', ']') {
  xxx.each {|yyy|
    unless q.first?
      q.text ','
      q.breakable
    end
    ... pretty printing yyy ...
  }
}</pre>

<p>first? is obsoleted in 1.8.2.</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 118</span>

<span class='kw'>def</span> <span class='id first?'>first?</span>
  <span class='id warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PrettyPrint#first? is obsoleted at 1.8.2.</span><span class='tstring_end'>&quot;</span></span>
  <span class='id current_group'>current_group</span><span class='period'>.</span><span class='id first?'>first?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="flush-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>flush</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>outputs buffered data.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246
247
248
249
250</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 244</span>

<span class='kw'>def</span> <span class='id flush'>flush</span>
  <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id data'>data</span><span class='op'>|</span>
    <span class='ivar'>@output_width</span> <span class='op'>=</span> <span class='id data'>data</span><span class='period'>.</span><span class='id output'>output</span><span class='lparen'>(</span><span class='ivar'>@output</span><span class='comma'>,</span> <span class='ivar'>@output_width</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
  <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id clear'>clear</span>
  <span class='ivar'>@buffer_width</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="group-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>group</strong>(indent = 0, open_obj = '', close_obj = '', open_width = open_obj.length, close_width = close_obj.length) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Groups line break hints added in the block. The line break hints are all to
be used or not.</p>

<p>If <tt>indent</tt> is specified, the method call is regarded as nested by
nest(indent) { ... }.</p>

<p>If <tt>open_obj</tt> is specified, <tt>text open_obj, open_width</tt> is
called before grouping. If <tt>close_obj</tt> is specified, <tt>text
close_obj, close_width</tt> is called after grouping.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 206</span>

<span class='kw'>def</span> <span class='id group'>group</span><span class='lparen'>(</span><span class='id indent'>indent</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id open_obj'>open_obj</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id close_obj'>close_obj</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id open_width'>open_width</span><span class='op'>=</span><span class='id open_obj'>open_obj</span><span class='period'>.</span><span class='id length'>length</span><span class='comma'>,</span> <span class='id close_width'>close_width</span><span class='op'>=</span><span class='id close_obj'>close_obj</span><span class='period'>.</span><span class='id length'>length</span><span class='rparen'>)</span>
  <span class='id text'>text</span> <span class='id open_obj'>open_obj</span><span class='comma'>,</span> <span class='id open_width'>open_width</span>
  <span class='id group_sub'>group_sub</span> <span class='lbrace'>{</span>
    <span class='id nest'>nest</span><span class='lparen'>(</span><span class='id indent'>indent</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='kw'>yield</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
  <span class='id text'>text</span> <span class='id close_obj'>close_obj</span><span class='comma'>,</span> <span class='id close_width'>close_width</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="group_sub-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>group_sub</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224
225
226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 216</span>

<span class='kw'>def</span> <span class='id group_sub'>group_sub</span>
  <span class='id group'>group</span> <span class='op'>=</span> <span class='const'>Group</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='ivar'>@group_stack</span><span class='period'>.</span><span class='id last'>last</span><span class='period'>.</span><span class='id depth'>depth</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='ivar'>@group_stack</span><span class='period'>.</span><span class='id push'>push</span> <span class='id group'>group</span>
  <span class='ivar'>@group_queue</span><span class='period'>.</span><span class='id enq'>enq</span> <span class='id group'>group</span>
  <span class='kw'>begin</span>
    <span class='kw'>yield</span>
  <span class='kw'>ensure</span>
    <span class='ivar'>@group_stack</span><span class='period'>.</span><span class='id pop'>pop</span>
    <span class='kw'>if</span> <span class='id group'>group</span><span class='period'>.</span><span class='id breakables'>breakables</span><span class='period'>.</span><span class='id empty?'>empty?</span>
      <span class='ivar'>@group_queue</span><span class='period'>.</span><span class='id delete'>delete</span> <span class='id group'>group</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="nest-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>nest</strong>(indent) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Increases left margin after newline with <tt>indent</tt> for line breaks
added in the block.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239
240</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 233</span>

<span class='kw'>def</span> <span class='id nest'>nest</span><span class='lparen'>(</span><span class='id indent'>indent</span><span class='rparen'>)</span>
  <span class='ivar'>@indent</span> <span class='op'>+=</span> <span class='id indent'>indent</span>
  <span class='kw'>begin</span>
    <span class='kw'>yield</span>
  <span class='kw'>ensure</span>
    <span class='ivar'>@indent</span> <span class='op'>-=</span> <span class='id indent'>indent</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="text-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>text</strong>(obj, width = obj.length) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This adds <tt>obj</tt> as a text of <tt>width</tt> columns in width.</p>

<p>If <tt>width</tt> is not specified, obj.length is used.</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/prettyprint.rb', line 144</span>

<span class='kw'>def</span> <span class='id text'>text</span><span class='lparen'>(</span><span class='id obj'>obj</span><span class='comma'>,</span> <span class='id width'>width</span><span class='op'>=</span><span class='id obj'>obj</span><span class='period'>.</span><span class='id length'>length</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='ivar'>@output</span> <span class='op'>&lt;&lt;</span> <span class='id obj'>obj</span>
    <span class='ivar'>@output_width</span> <span class='op'>+=</span> <span class='id width'>width</span>
  <span class='kw'>else</span>
    <span class='id text'>text</span> <span class='op'>=</span> <span class='ivar'>@buffer</span><span class='period'>.</span><span class='id last'>last</span>
    <span class='kw'>unless</span> <span class='const'>Text</span> <span class='op'>===</span> <span class='id text'>text</span>
      <span class='id text'>text</span> <span class='op'>=</span> <span class='const'>Text</span><span class='period'>.</span><span class='id new'>new</span>
      <span class='ivar'>@buffer</span> <span class='op'>&lt;&lt;</span> <span class='id text'>text</span>
    <span class='kw'>end</span>
    <span class='id text'>text</span><span class='period'>.</span><span class='id add'>add</span><span class='lparen'>(</span><span class='id obj'>obj</span><span class='comma'>,</span> <span class='id width'>width</span><span class='rparen'>)</span>
    <span class='ivar'>@buffer_width</span> <span class='op'>+=</span> <span class='id width'>width</span>
    <span class='id break_outmost_groups'>break_outmost_groups</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Sep  3 14:10:56 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.3).
</div>

  </body>
</html>