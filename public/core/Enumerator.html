<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Enumerator</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./enumerator_c.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="enumerator.c">enumerator.c</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="Object.html">Object</a></p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="Enumerator/Generator.html">Enumerator::Generator</a></li>
          
          <li><span class="type">CLASS</span> <a href="Enumerator/Yielder.html">Enumerator::Yielder</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-each">#each</a></li>
          
          <li><a href="#method-i-each_with_index">#each_with_index</a></li>
          
          <li><a href="#method-i-each_with_object">#each_with_object</a></li>
          
          <li><a href="#method-i-feed">#feed</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-next">#next</a></li>
          
          <li><a href="#method-i-next_values">#next_values</a></li>
          
          <li><a href="#method-i-peek">#peek</a></li>
          
          <li><a href="#method-i-peek_values">#peek_values</a></li>
          
          <li><a href="#method-i-rewind">#rewind</a></li>
          
          <li><a href="#method-i-with_index">#with_index</a></li>
          
          <li><a href="#method-i-with_object">#with_object</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="Enumerable.html">Enumerable</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./Encoding.html">Encoding</a></li>
        
          <li><a href="./Encoding/CompatibilityError.html">Encoding::CompatibilityError</a></li>
        
          <li><a href="./Encoding/Converter.html">Encoding::Converter</a></li>
        
          <li><a href="./Encoding/ConverterNotFoundError.html">Encoding::ConverterNotFoundError</a></li>
        
          <li><a href="./Encoding/InvalidByteSequenceError.html">Encoding::InvalidByteSequenceError</a></li>
        
          <li><a href="./Encoding/UndefinedConversionError.html">Encoding::UndefinedConversionError</a></li>
        
          <li><a href="./Process.html">Process</a></li>
        
          <li><a href="./Process/GID.html">Process::GID</a></li>
        
          <li><a href="./Process/Status.html">Process::Status</a></li>
        
          <li><a href="./Process/Sys.html">Process::Sys</a></li>
        
          <li><a href="./Process/UID.html">Process::UID</a></li>
        
          <li><a href="./Enumerator.html">Enumerator</a></li>
        
          <li><a href="./Enumerator/Generator.html">Enumerator::Generator</a></li>
        
          <li><a href="./Enumerator/Yielder.html">Enumerator::Yielder</a></li>
        
          <li><a href="./File.html">File</a></li>
        
          <li><a href="./File/Constants.html">File::Constants</a></li>
        
          <li><a href="./File/Stat.html">File::Stat</a></li>
        
          <li><a href="./IO.html">IO</a></li>
        
          <li><a href="./IO/WaitReadable.html">IO::WaitReadable</a></li>
        
          <li><a href="./IO/WaitWritable.html">IO::WaitWritable</a></li>
        
          <li><a href="./RubyVM.html">RubyVM</a></li>
        
          <li><a href="./RubyVM/Env.html">RubyVM::Env</a></li>
        
          <li><a href="./RubyVM/InstructionSequence.html">RubyVM::InstructionSequence</a></li>
        
          <li><a href="./GC.html">GC</a></li>
        
          <li><a href="./GC/Profiler.html">GC::Profiler</a></li>
        
          <li><a href="./Math.html">Math</a></li>
        
          <li><a href="./Math/DomainError.html">Math::DomainError</a></li>
        
          <li><a href="./NameError.html">NameError</a></li>
        
          <li><a href="./NameError/message.html">NameError::message</a></li>
        
          <li><a href="./ARGF.html">ARGF</a></li>
        
          <li><a href="./ArgumentError.html">ArgumentError</a></li>
        
          <li><a href="./Array.html">Array</a></li>
        
          <li><a href="./BasicObject.html">BasicObject</a></li>
        
          <li><a href="./Bignum.html">Bignum</a></li>
        
          <li><a href="./Binding.html">Binding</a></li>
        
          <li><a href="./Class.html">Class</a></li>
        
          <li><a href="./Comparable.html">Comparable</a></li>
        
          <li><a href="./Complex.html">Complex</a></li>
        
          <li><a href="./Continuation.html">Continuation</a></li>
        
          <li><a href="./Data.html">Data</a></li>
        
          <li><a href="./Dir.html">Dir</a></li>
        
          <li><a href="./ENV.html">ENV</a></li>
        
          <li><a href="./EOFError.html">EOFError</a></li>
        
          <li><a href="./EncodingError.html">EncodingError</a></li>
        
          <li><a href="./Enumerable.html">Enumerable</a></li>
        
          <li><a href="./Errno.html">Errno</a></li>
        
          <li><a href="./Exception.html">Exception</a></li>
        
          <li><a href="./FalseClass.html">FalseClass</a></li>
        
          <li><a href="./Fiber.html">Fiber</a></li>
        
          <li><a href="./FiberError.html">FiberError</a></li>
        
          <li><a href="./FileTest.html">FileTest</a></li>
        
          <li><a href="./Fixnum.html">Fixnum</a></li>
        
          <li><a href="./Float.html">Float</a></li>
        
          <li><a href="./FloatDomainError.html">FloatDomainError</a></li>
        
          <li><a href="./Hash.html">Hash</a></li>
        
          <li><a href="./IOError.html">IOError</a></li>
        
          <li><a href="./IndexError.html">IndexError</a></li>
        
          <li><a href="./Integer.html">Integer</a></li>
        
          <li><a href="./Interrupt.html">Interrupt</a></li>
        
          <li><a href="./Kernel.html">Kernel</a></li>
        
          <li><a href="./KeyError.html">KeyError</a></li>
        
          <li><a href="./LoadError.html">LoadError</a></li>
        
          <li><a href="./LocalJumpError.html">LocalJumpError</a></li>
        
          <li><a href="./Marshal.html">Marshal</a></li>
        
          <li><a href="./MatchData.html">MatchData</a></li>
        
          <li><a href="./Method.html">Method</a></li>
        
          <li><a href="./Module.html">Module</a></li>
        
          <li><a href="./Mutex.html">Mutex</a></li>
        
          <li><a href="./NilClass.html">NilClass</a></li>
        
          <li><a href="./NoMemoryError.html">NoMemoryError</a></li>
        
          <li><a href="./NoMethodError.html">NoMethodError</a></li>
        
          <li><a href="./NotImplementedError.html">NotImplementedError</a></li>
        
          <li><a href="./Numeric.html">Numeric</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
          <li><a href="./ObjectSpace.html">ObjectSpace</a></li>
        
          <li><a href="./Proc.html">Proc</a></li>
        
          <li><a href="./Random.html">Random</a></li>
        
          <li><a href="./Range.html">Range</a></li>
        
          <li><a href="./RangeError.html">RangeError</a></li>
        
          <li><a href="./Rational.html">Rational</a></li>
        
          <li><a href="./Regexp.html">Regexp</a></li>
        
          <li><a href="./RegexpError.html">RegexpError</a></li>
        
          <li><a href="./Ripper.html">Ripper</a></li>
        
          <li><a href="./RuntimeError.html">RuntimeError</a></li>
        
          <li><a href="./ScriptError.html">ScriptError</a></li>
        
          <li><a href="./SecurityError.html">SecurityError</a></li>
        
          <li><a href="./Signal.html">Signal</a></li>
        
          <li><a href="./SignalException.html">SignalException</a></li>
        
          <li><a href="./StandardError.html">StandardError</a></li>
        
          <li><a href="./StopIteration.html">StopIteration</a></li>
        
          <li><a href="./String.html">String</a></li>
        
          <li><a href="./Struct.html">Struct</a></li>
        
          <li><a href="./Symbol.html">Symbol</a></li>
        
          <li><a href="./SyntaxError.html">SyntaxError</a></li>
        
          <li><a href="./SystemCallError.html">SystemCallError</a></li>
        
          <li><a href="./SystemExit.html">SystemExit</a></li>
        
          <li><a href="./SystemStackError.html">SystemStackError</a></li>
        
          <li><a href="./Thread.html">Thread</a></li>
        
          <li><a href="./ThreadError.html">ThreadError</a></li>
        
          <li><a href="./ThreadGroup.html">ThreadGroup</a></li>
        
          <li><a href="./Time.html">Time</a></li>
        
          <li><a href="./TrueClass.html">TrueClass</a></li>
        
          <li><a href="./TypeError.html">TypeError</a></li>
        
          <li><a href="./UnboundMethod.html">UnboundMethod</a></li>
        
          <li><a href="./ZeroDivisionError.html">ZeroDivisionError</a></li>
        
          <li><a href="./fatal.html">fatal</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Enumerator</h1>

    <div id="description" class="description">
      
<p>A class which allows both internal and external iteration.</p>

<p>An <a href="Enumerator.html">Enumerator</a> can be created by the following
methods.</p>
<ul><li>
<p>Kernel#to_enum</p>
</li><li>
<p>Kernel#enum_for</p>
</li><li>
<p><a href="Enumerator.html#method-c-new">Enumerator.new</a></p>
</li></ul>

<p>Most methods have two forms: a block form where the contents are evaluated
for each item in the enumeration, and a non-block form which returns a new
<a href="Enumerator.html">Enumerator</a> wrapping the iteration.</p>

<pre>enumerator = %w(one two three).each
puts enumerator.class # =&gt; Enumerator
enumerator.each_with_object(&quot;foo&quot;) do |item,obj|
  puts &quot;#{obj}: #{item}&quot;
end
# foo: one
# foo: two
# foo: three
enum_with_obj = enumerator.each_with_object(&quot;foo&quot;)
puts enum_with_obj.class # =&gt; Enumerator
enum_with_obj.each do |item,obj|
  puts &quot;#{obj: #{item}&quot;
end
# foo: one
# foo: two
# foo: three</pre>

<p>This allows you to chain Enumerators together.  For example, you can map a
list’s elements to strings containing the index and the element as a string
via:</p>

<pre>puts %w[foo bar baz].map.with_index {|w,i| &quot;#{i}:#{w}&quot; }
# =&gt; [&quot;0:foo&quot;, &quot;1:bar&quot;, &quot;2:baz&quot;]</pre>

<p>An <a href="Enumerator.html">Enumerator</a> can also be used as an external
iterator. For example, <a
href="Enumerator.html#method-i-next">Enumerator#next</a> returns the next
value of the iterator or raises <a
href="StopIteration.html">StopIteration</a> if the <a
href="Enumerator.html">Enumerator</a> is at the end.</p>

<pre>e = [1,2,3].each   # returns an enumerator object.
puts e.next   # =&gt; 1
puts e.next   # =&gt; 2
puts e.next   # =&gt; 3
puts e.next   # raises StopIteration</pre>

<p>You can use this to implement an internal iterator as follows:</p>

<pre>def ext_each(e)
  while true
    begin
      vs = e.next_values
    rescue StopIteration
      return $!.result
    end
    y = yield(*vs)
    e.feed y
  end
end

o = Object.new

def o.each
  puts yield
  puts yield(1)
  puts yield(1, 2)
  3
end

# use o.each as an internal iterator directly.
puts o.each {|*x| puts x; [:b, *x] }
# =&gt; [], [:b], [1], [:b, 1], [1, 2], [:b, 1, 2], 3

# convert o.each to an external iterator for
# implementing an internal iterator.
puts ext_each(o.to_enum) {|*x| puts x; [:b, *x] }
# =&gt; [], [:b], [1], [:b, 1], [1, 2], [:b, 1, 2], 3</pre>

    </div><!-- description -->

    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">new { |yielder| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">new(obj, method = :each, *args)</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Creates a new <a href="Enumerator.html">Enumerator</a> object, which can be
used as an <a href="Enumerable.html">Enumerable</a>.</p>

<p>In the first form, iteration is defined by the given block, in which a
“yielder” object, given as block parameter, can be used to yield a value by
calling the <tt>yield</tt> method (aliased as +&lt;&lt;+):</p>

<pre>fib = Enumerator.new do |y|
  a = b = 1
  loop do
    y &lt;&lt; a
    a, b = b, a + b
  end
end

p fib.take(10) # =&gt; [1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</pre>

<p>In the second, deprecated, form, a generated <a
href="Enumerator.html">Enumerator</a> iterates over the given object using
the given method with the given arguments passed.</p>

<p>Use of this form is discouraged.  Use Kernel#enum_for or Kernel#to_enum
instead.</p>

<pre>e = Enumerator.new(ObjectSpace, :each_object)
    #-&gt; ObjectSpace.enum_for(:each_object)

e.select { |obj| obj.is_a?(Class) }  #=&gt; array of all classes</pre>
            

            
            <div class="method-source-code" id="new-source">
<pre>
static VALUE
enumerator_initialize(int argc, VALUE *argv, VALUE obj)
{
    VALUE recv, meth = sym_each;

    if (argc == 0) {
        if (!rb_block_given_p())
            rb_raise(rb_eArgError, &quot;wrong number of argument (0 for 1+)&quot;);

        recv = generator_init(generator_allocate(rb_cGenerator), rb_block_proc());
    }
    else {
        recv = *argv++;
        if (--argc) {
            meth = *argv++;
            --argc;
        }
    }

    return enumerator_init(obj, recv, meth, argc, argv);
}</pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="each-method" class="method-detail ">
          <a name="method-i-each"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">each {...}</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Iterates over the block according to how this <a
href="Enumerable.html">Enumerable</a> was constructed. If no block is
given, returns self.</p>
            

            
            <div class="method-source-code" id="each-source">
<pre>
static VALUE
enumerator_each(VALUE obj)
{
    if (!rb_block_given_p()) return obj;
    return enumerator_block_call(obj, 0, obj);
}</pre>
            </div><!-- each-source -->
            
          </div>

          

          
        </div><!-- each-method -->

      
        <div id="each_with_index-method" class="method-detail ">
          <a name="method-i-each_with_index"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">each_with_index {|(*args), idx| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">each_with_index</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Same as <a
href="Enumerator.html#method-i-with_index">Enumerator#with_index(0)</a>,
i.e. there is no starting offset.</p>

<p>If no block is given, a new <a href="Enumerator.html">Enumerator</a> is
returned that includes the index.</p>
            

            
            <div class="method-source-code" id="each_with_index-source">
<pre>
static VALUE
enumerator_each_with_index(VALUE obj)
{
    return enumerator_with_index(0, NULL, obj);
}</pre>
            </div><!-- each_with_index-source -->
            
          </div>

          

          
        </div><!-- each_with_index-method -->

      
        <div id="each_with_object-method" class="method-detail ">
          <a name="method-i-each_with_object"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">with_object(obj) {|(*args), obj| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">with_object(obj)</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Iterates the given block for each element with an arbitrary object,
<tt>obj</tt>, and returns <tt>obj</tt></p>

<p>If no block is given, returns a new <a
href="Enumerator.html">Enumerator</a>.</p>

<h3>Example</h3>

<pre>to_three = Enumerator.new do |y|
  3.times do |x|
    y &lt;&lt; x
  end
end

to_three_with_string = to_three.with_object(&quot;foo&quot;)
to_three_with_string.each do |x,string|
  puts &quot;#{string}: #{x}&quot;
end

# =&gt; foo:0
# =&gt; foo:1
# =&gt; foo:2</pre>
            

            
            <div class="method-source-code" id="each_with_object-source">
<pre>
static VALUE
enumerator_with_object(VALUE obj, VALUE memo)
{
    RETURN_ENUMERATOR(obj, 1, &amp;memo);
    enumerator_block_call(obj, enumerator_with_object_i, memo);

    return memo;
}</pre>
            </div><!-- each_with_object-source -->
            
          </div>

          

          
        </div><!-- each_with_object-method -->

      
        <div id="feed-method" class="method-detail ">
          <a name="method-i-feed"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">feed obj   &rarr; nil</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Sets the value to be returned by the next yield inside <tt>e</tt>.</p>

<p>If the value is not set, the yield returns nil.</p>

<p>This value is cleared after being yielded.</p>

<pre>o = Object.new
def o.each
  x = yield         # (2) blocks
  p x               # (5) =&gt; &quot;foo&quot;
  x = yield         # (6) blocks
  p x               # (8) =&gt; nil
  x = yield         # (9) blocks
  p x               # not reached w/o another e.next
end

e = o.to_enum
e.next              # (1)
e.feed &quot;foo&quot;        # (3)
e.next              # (4)
e.next              # (7)
                    # (10)</pre>
            

            
            <div class="method-source-code" id="feed-source">
<pre>
static VALUE
enumerator_feed(VALUE obj, VALUE v)
{
    struct enumerator *e = enumerator_ptr(obj);

    if (e-&gt;feedvalue != Qundef) {
        rb_raise(rb_eTypeError, &quot;feed value already set&quot;);
    }
    e-&gt;feedvalue = v;

    return Qnil;
}</pre>
            </div><!-- feed-source -->
            
          </div>

          

          
        </div><!-- feed-method -->

      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">inspect  &rarr; string</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Creates a printable version of <em>e</em>.</p>
            

            
            <div class="method-source-code" id="inspect-source">
<pre>
static VALUE
enumerator_inspect(VALUE obj)
{
    return rb_exec_recursive(inspect_enumerator, obj, 0);
}</pre>
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->

      
        <div id="next-method" class="method-detail ">
          <a name="method-i-next"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">next   &rarr; object</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the next object in the enumerator, and move the internal position
forward.  When the position reached at the end, <a
href="StopIteration.html">StopIteration</a> is raised.</p>

<h3>Example</h3>

<pre>a = [1,2,3]
e = a.to_enum
p e.next   #=&gt; 1
p e.next   #=&gt; 2
p e.next   #=&gt; 3
p e.next   #raises StopIteration</pre>

<p>Note that enumeration sequence by <tt>next</tt> does not affect other
non-external enumeration methods, unless the underlying iteration methods
itself has side-effect, e.g. <a
href="IO.html#method-i-each_line">IO#each_line</a>.</p>
            

            
            <div class="method-source-code" id="next-source">
<pre>
static VALUE
enumerator_next(VALUE obj)
{
    VALUE vs = enumerator_next_values(obj);
    return ary2sv(vs, 0);
}</pre>
            </div><!-- next-source -->
            
          </div>

          

          
        </div><!-- next-method -->

      
        <div id="next_values-method" class="method-detail ">
          <a name="method-i-next_values"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">next_values   &rarr; array</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the next object as an array in the enumerator, and move the
internal position forward.  When the position reached at the end, <a
href="StopIteration.html">StopIteration</a> is raised.</p>

<p>This method can be used to distinguish <tt>yield</tt> and <tt>yield
nil</tt>.</p>

<h3>Example</h3>

<pre>o = Object.new
def o.each
  yield
  yield 1
  yield 1, 2
  yield nil
  yield [1, 2]
end
e = o.to_enum
p e.next_values
p e.next_values
p e.next_values
p e.next_values
p e.next_values
e = o.to_enum
p e.next
p e.next
p e.next
p e.next
p e.next

## yield args       next_values      next
#  yield            []               nil
#  yield 1          [1]              1
#  yield 1, 2       [1, 2]           [1, 2]
#  yield nil        [nil]            nil
#  yield [1, 2]     [[1, 2]]         [1, 2]</pre>

<p>Note that <tt><a
href="Enumerator.html#method-i-next_values">next_values</a></tt> does not
affect other non-external enumeration methods unless underlying iteration
method itself has side-effect, e.g. <a
href="IO.html#method-i-each_line">IO#each_line</a>.</p>
            

            
            <div class="method-source-code" id="next_values-source">
<pre>
static VALUE
enumerator_next_values(VALUE obj)
{
    struct enumerator *e = enumerator_ptr(obj);
    VALUE vs;

    if (e-&gt;lookahead != Qundef) {
        vs = e-&gt;lookahead;
        e-&gt;lookahead = Qundef;
        return vs;
    }

    return get_next_values(obj, e);
}</pre>
            </div><!-- next_values-source -->
            
          </div>

          

          
        </div><!-- next_values-method -->

      
        <div id="peek-method" class="method-detail ">
          <a name="method-i-peek"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">peek   &rarr; object</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the next object in the enumerator, but doesn’t move the internal
position forward.  If the position is already at the end, <a
href="StopIteration.html">StopIteration</a> is raised.</p>

<h3>Example</h3>

<pre>a = [1,2,3]
e = a.to_enum
p e.next   #=&gt; 1
p e.peek   #=&gt; 2
p e.peek   #=&gt; 2
p e.peek   #=&gt; 2
p e.next   #=&gt; 2
p e.next   #=&gt; 3
p e.next   #raises StopIteration</pre>
            

            
            <div class="method-source-code" id="peek-source">
<pre>
static VALUE
enumerator_peek(VALUE obj)
{
    VALUE vs = enumerator_peek_values(obj);
    return ary2sv(vs, 1);
}</pre>
            </div><!-- peek-source -->
            
          </div>

          

          
        </div><!-- peek-method -->

      
        <div id="peek_values-method" class="method-detail ">
          <a name="method-i-peek_values"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">peek_values   &rarr; array</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Returns the next object as an array, similar to <a
href="Enumerator.html#method-i-next_values">Enumerator#next_values</a>, but
doesn’t move the internal position forward.  If the position is already at
the end, <a href="StopIteration.html">StopIteration</a> is raised.</p>

<h3>Example</h3>

<pre>o = Object.new
def o.each
  yield
  yield 1
  yield 1, 2
end
e = o.to_enum
p e.peek_values    #=&gt; []
e.next
p e.peek_values    #=&gt; [1]
p e.peek_values    #=&gt; [1]
e.next
p e.peek_values    #=&gt; [1, 2]
e.next
p e.peek_values    # raises StopIteration</pre>
            

            
            <div class="method-source-code" id="peek_values-source">
<pre>
static VALUE
enumerator_peek_values_m(VALUE obj)
{
    return rb_ary_dup(enumerator_peek_values(obj));
}</pre>
            </div><!-- peek_values-source -->
            
          </div>

          

          
        </div><!-- peek_values-method -->

      
        <div id="rewind-method" class="method-detail ">
          <a name="method-i-rewind"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">rewind   &rarr; e</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Rewinds the enumeration sequence by one step.</p>

<p>If the enclosed object responds to a “rewind” method, it is called.</p>
            

            
            <div class="method-source-code" id="rewind-source">
<pre>
static VALUE
enumerator_rewind(VALUE obj)
{
    struct enumerator *e = enumerator_ptr(obj);

    rb_check_funcall(e-&gt;obj, id_rewind, 0, 0);

    e-&gt;fib = 0;
    e-&gt;dst = Qnil;
    e-&gt;lookahead = Qundef;
    e-&gt;feedvalue = Qundef;
    e-&gt;stop_exc = Qfalse;
    return obj;
}</pre>
            </div><!-- rewind-source -->
            
          </div>

          

          
        </div><!-- rewind-method -->

      
        <div id="with_index-method" class="method-detail ">
          <a name="method-i-with_index"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">with_index(offset = 0) {|(*args), idx| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">with_index(offset = 0)</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Iterates the given block for each element with an index, which starts from
<tt>offset</tt>.  If no block is given, returns a new <a
href="Enumerator.html">Enumerator</a> that includes the index, starting
from <tt>offset</tt></p>
<table class="rdoc-list"><tr><td class="rdoc-term"><p><tt>offset</tt></p></td>
<td>
<p>the starting index to use</p>
</td></tr></table>
            

            
            <div class="method-source-code" id="with_index-source">
<pre>
static VALUE
enumerator_with_index(int argc, VALUE *argv, VALUE obj)
{
    VALUE memo;

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;memo);
    RETURN_ENUMERATOR(obj, argc, argv);
    memo = NIL_P(memo) ? 0 : (VALUE)NUM2LONG(memo);
    return enumerator_block_call(obj, enumerator_with_index_i, (VALUE)&amp;memo);
}</pre>
            </div><!-- with_index-source -->
            
          </div>

          

          
        </div><!-- with_index-method -->

      
        <div id="with_object-method" class="method-detail ">
          <a name="method-i-with_object"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">with_object(obj) {|(*args), obj| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">with_object(obj)</span>
            
          </div>
          
          

          <div class="method-description">
            
            <p>Iterates the given block for each element with an arbitrary object,
<tt>obj</tt>, and returns <tt>obj</tt></p>

<p>If no block is given, returns a new <a
href="Enumerator.html">Enumerator</a>.</p>

<h3>Example</h3>

<pre>to_three = Enumerator.new do |y|
  3.times do |x|
    y &lt;&lt; x
  end
end

to_three_with_string = to_three.with_object(&quot;foo&quot;)
to_three_with_string.each do |x,string|
  puts &quot;#{string}: #{x}&quot;
end

# =&gt; foo:0
# =&gt; foo:1
# =&gt; foo:2</pre>
            

            
            <div class="method-source-code" id="with_object-source">
<pre>
static VALUE
enumerator_with_object(VALUE obj, VALUE memo)
{
    RETURN_ENUMERATOR(obj, 1, &amp;memo);
    enumerator_block_call(obj, enumerator_with_object_i, memo);

    return memo;
}</pre>
            </div><!-- with_object-source -->
            
          </div>

          

          
        </div><!-- with_object-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

